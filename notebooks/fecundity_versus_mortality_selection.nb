(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    201606,       5403]
NotebookOptionsPosition[    179627,       5108]
NotebookOutlinePosition[    179968,       5123]
CellTagsIndexPosition[    179925,       5120]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Fecundity versus Mortality Selection and the Evolution of Parental \
Effects",
  FontSlant->"Italic"],
 "\nSupplementary Mathematica File 2: Evolution of Parental Effects"
}], "Section",
 CellChangeTimes->{{3.740372208703034*^9, 3.740372209478878*^9}, {
  3.740373444714129*^9, 3.740373449321692*^9}, {3.7403911456306047`*^9, 
  3.7403911650981197`*^9}, {3.741941437388195*^9, 3.7419414401960793`*^9}, {
  3.741941570276346*^9, 3.741941589220549*^9}, {3.742090572777955*^9, 
  3.742090597698339*^9}},ExpressionUUID->"8b1b4bc5-1188-4c4a-ab88-\
f72346623336"],

Cell["Bram Kuijper", "Text",
 CellChangeTimes->{{3.740391177046467*^9, 3.7403911869829082`*^9}, {
  3.775284782647476*^9, 
  3.775284783854721*^9}},ExpressionUUID->"48eb3ed0-8865-4063-bee5-\
098cda380892"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.740391188657177*^9, 3.740391198351039*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c0e8e433-bd90-449d-8b94-7fce98fe78f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Parameters", "Section",
 CellChangeTimes->{{3.74194150869274*^9, 3.7419415097320147`*^9}, {
  3.74203164570004*^9, 
  3.7420316458438473`*^9}},ExpressionUUID->"6598478b-1cd2-4a46-830d-\
cfb3120b5cca"],

Cell["Number of breeders per patch", "Text",
 CellChangeTimes->{{3.74194151123604*^9, 
  3.7419415172086906`*^9}},ExpressionUUID->"e286163c-4df1-41e8-86d5-\
540ee303ad7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.7419415181615334`*^9, 3.74194152146102*^9}, {
   3.74195184859011*^9, 3.741951849503716*^9}, 3.7420906075296793`*^9, {
   3.7752855360076513`*^9, 3.7752855379673767`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b0ecde9e-ce09-4b91-a3cb-f189b2fc0831"],

Cell[TextData[{
 "Map adapted state (i.e., an individual\[CloseCurlyQuote]s match with its \
environment) ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "d"], TraditionalForm]],ExpressionUUID->
  "1e483851-33bb-4c67-b5fd-5f6cb554b1e0"],
 " state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "45991bbb-d733-40fe-a336-82f148dd2c68"],
 " (adapted, maladapted) to a numerical value, with a=1,m=0"
}], "Text",
 CellChangeTimes->{{3.741945557556073*^9, 3.7419455966123457`*^9}, {
  3.77528479618361*^9, 
  3.775284816182703*^9}},ExpressionUUID->"0645c0f6-1432-48c4-9c11-\
84a6695cb6fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"countAd", "[", "adapted_", "]"}], ":=", 
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{"{", "adapted", "}"}], ",", "a"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741945600198799*^9, 3.741945617444715*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"a240eeb1-723a-4a95-84b1-1c872fc6a438"],

Cell[TextData[{
 "Return opposite ",
 Cell[BoxData[
  FormBox[
   RowBox[{"!", 
    SubscriptBox["a", "d"]}], TraditionalForm]],ExpressionUUID->
  "8f3ad8b0-f4f4-41e7-a49a-bcadc8645b2f"],
 " to current adapted state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "d"], TraditionalForm]],ExpressionUUID->
  "b35cd713-1feb-4ac8-9f22-dbe39bcb4d69"],
 " state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "d97c9bc6-00db-44a9-a378-911759e18a7e"],
 " (adapted, maladapted) to a count"
}], "Text",
 CellChangeTimes->{{3.741945737700306*^9, 
  3.741945759676642*^9}},ExpressionUUID->"d833f010-487c-4732-95ec-\
225d51107149"],

Cell[BoxData[
 RowBox[{
  RowBox[{"switchAd", "[", "adapted_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "m"}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "adapted", "}"}], ",", "a"}], "]"}], "+", "1"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.741945760915168*^9, 3.741945792188678*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"4cfd3550-6609-4206-b6ee-6709cf4b6812"],

Cell[TextData[{
 "Fecundity of individuals living in environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "x"], TraditionalForm]],ExpressionUUID->
  "758b874e-c860-4e96-93b0-5ac45faad972"],
 " and in state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "3fcdb3bc-d9aa-45ce-ae30-44671e4bfd84"],
 " (adapted, maladapted):"
}], "Text",
 CellChangeTimes->{{3.741942819061282*^9, 3.7419428230288343`*^9}, {
  3.74194294090079*^9, 
  3.7419430119705143`*^9}},ExpressionUUID->"c321cee8-4dec-40db-b229-\
b4d73e656352"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "[", 
   RowBox[{"ex_", ",", "ad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Fm1", ",", "Fa1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Fm2", ",", "Fa2"}], "}"}]}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{"ex", ",", 
     RowBox[{
      RowBox[{"countAd", "[", "ad", "]"}], "+", "1"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7419428056603527`*^9, 3.7419429202610826`*^9}, {
  3.74194295856567*^9, 3.741942962317182*^9}, {3.741945644765094*^9, 
  3.74194564754872*^9}, {3.77528832538715*^9, 3.7752883280090303`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c77b41d2-592b-42a3-ab87-94b1873b048f"],

Cell[TextData[{
 "Mortality of individuals living in environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "x"], TraditionalForm]],ExpressionUUID->
  "f3284fdb-e8e0-4329-b4f5-ba7dccd9bd6c"],
 " and in state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "6592e0ff-86d3-428d-ab55-a00566973ced"],
 " (adapted, maladapted):"
}], "Text",
 CellChangeTimes->{{3.7419430146608887`*^9, 
  3.741943033509104*^9}},ExpressionUUID->"d6aed044-ed4c-495d-91e1-\
7bfa835233e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"ex_", ",", "ad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cm1", ",", "Ca1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Cm2", ",", "Ca2"}], "}"}]}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{"ex", ",", 
     RowBox[{
      RowBox[{"countAd", "[", "ad", "]"}], "+", "1"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7419430395811243`*^9, 3.741943048669222*^9}, 
   3.741945656799007*^9, {3.775288331530796*^9, 3.7752883397609386`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"711b2a98-85c1-4c3c-ba0d-a1075fad111e"],

Cell[TextData[{
 "Phenotype determination (probability of producing an opposite phenotype to \
one\[CloseCurlyQuote]s own) by adult breeders in environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "x"], TraditionalForm]],ExpressionUUID->
  "d6e22617-5232-4ab9-a08d-7ab08b6d196a"],
 " and in state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "e0025e25-86fe-4269-ad42-d2b0b636e7d5"],
 " (adapted, maladapted):"
}], "Text",
 CellChangeTimes->{{3.741943090524728*^9, 3.741943132461028*^9}, {
  3.741943192086109*^9, 3.741943192948975*^9}, {3.741944328220519*^9, 
  3.741944342836382*^9}},ExpressionUUID->"2588f3e9-de90-47d2-8d4b-\
8332d0fec99a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "[", 
   RowBox[{"ex_", ",", "ad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "p2"}], "+", 
        RowBox[{"\[Epsilon]", " ", "p1"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "p1"}], ")"}]}], "+", 
        RowBox[{"\[Epsilon]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p2"}], ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "p1"}], ")"}]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p2"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "p2"}], "+", 
        RowBox[{"\[Epsilon]", " ", "p1"}]}]}], "}"}]}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{"ex", ",", 
     RowBox[{
      RowBox[{"countAd", "[", "ad", "]"}], "+", "1"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7419431354320707`*^9, 3.7419431895737143`*^9}, {
   3.741944345844864*^9, 3.741944348044788*^9}, {3.741944667252677*^9, 
   3.741944679334092*^9}, 3.741945659765679*^9, {3.742090841296475*^9, 
   3.742090843090562*^9}, {3.7420911748581057`*^9, 3.742091176495419*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"5ccb0aea-7b91-4bf7-857d-5672feecb100"],

Cell[TextData[{
 "Phenotype determination of a slightly different mutant (probability of \
producing an opposite phenotype to one\[CloseCurlyQuote]s own) by adult \
breeders in environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "x"], TraditionalForm]],ExpressionUUID->
  "2b5333c2-b8ea-4cd6-8229-bb62952cb173"],
 " and in state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "1ee22864-4949-4d01-b41a-8fb8325aba82"],
 " (adapted, maladapted):"
}], "Text",
 CellChangeTimes->{{3.74195186583877*^9, 
  3.741951875112788*^9}},ExpressionUUID->"b9ba38a8-32dd-4284-aac0-\
1eebe0534da3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
   RowBox[{"ex_", ",", "ad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "dp2"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dp1"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", "dp1"}], ")"}]}], "-", 
        RowBox[{"\[Epsilon]", " ", "dp2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", "dp1"}], ")"}]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{"-", "dp2"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "dp2"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dp1"}]}]}], "}"}]}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{"ex", ",", 
     RowBox[{
      RowBox[{"countAd", "[", "ad", "]"}], "+", "1"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7419431354320707`*^9, 3.7419431895737143`*^9}, {
   3.741944345844864*^9, 3.741944348044788*^9}, {3.741944667252677*^9, 
   3.741944679334092*^9}, 3.741945659765679*^9, {3.741951882616665*^9, 
   3.741951903192499*^9}, {3.742091135349484*^9, 3.74209113662976*^9}, {
   3.742091176997205*^9, 3.742091178870409*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"9036b7b5-d830-4d6a-9874-2f381f604303"],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.7419425899887857`*^9, 
  3.7419425977333937`*^9}},ExpressionUUID->"7229d772-9322-4f44-ac0a-\
9af691bad4ee"],

Cell[TextData[{
 "Probability that an adapted juvenile ",
 StyleBox["born in the local patch ",
  FontWeight->"Bold"],
 "occupies a vacant breeding site in an environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "0fdcf55e-188b-457a-93b3-9438d7873e04"],
 "-patch previously containing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "6dec98cb-b99e-4624-be5a-9c667529496b"],
 " adapted breeders:"
}], "Text",
 CellChangeTimes->{{3.741942691188779*^9, 
  3.741942713293621*^9}},ExpressionUUID->"67159869-9b31-4e0f-92fb-\
98656ddfe35e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localad", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["ai", "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "a"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "ai"}], "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.74194272473967*^9, 3.74194282847758*^9}, {
  3.741944689877367*^9, 3.741944693179062*^9}, {3.741944752458078*^9, 
  3.741944752655591*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"069b6de6-debc-4189-abc0-09b7ae49eb49"],

Cell[TextData[{
 "Probability that a maladapted juvenile ",
 StyleBox["born in the local patch ",
  FontWeight->"Bold"],
 "occupies a vacant breeding site in an environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "610504e4-efa7-44f8-b508-22489afeb605"],
 "-patch previously containing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "65576a3e-cb57-4dd2-a729-ac94ebe223da"],
 " adapted breeders:"
}], "Text",
 CellChangeTimes->{{3.741944414757864*^9, 
  3.741944419588295*^9}},ExpressionUUID->"3349bba1-448e-435e-acb0-\
6d3da28df85e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localmad", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["ai", "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "ai"}], "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "m"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741944401907195*^9, 3.741944405220155*^9}, {
  3.741944638468548*^9, 3.7419446591885433`*^9}, {3.7419446954213457`*^9, 
  3.741944698133581*^9}, {3.741944753947687*^9, 3.741944754132951*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b54a8811-c838-4ef3-b527-a162f3f6561f"],

Cell[TextData[{
 "Probability that an adapted juvenile ",
 StyleBox["born in a remote patch ",
  FontWeight->"Bold"],
 "occupies a vacant breeding site in an environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "5d58d765-a01b-4044-b69c-05ebfa0e265b"],
 "-patch"
}], "Text",
 CellChangeTimes->{{3.741943354764978*^9, 
  3.741943400124754*^9}},ExpressionUUID->"08e1e047-a75e-4fd2-b71f-\
4f298d1e7e01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dispad", "[", "ei_", "]"}], ":=", 
  RowBox[{"d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"eiRemote", ",", "aiRemote"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["aiRemote", "n"], 
         RowBox[{"B", "[", 
          RowBox[{"eiRemote", ",", "a"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ei", "\[Equal]", "eiRemote"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"eiRemote", ",", "a"}], "]"}]}], ",", 
           RowBox[{"\[ScriptCapitalP]", "[", 
            RowBox[{"eiRemote", ",", "a"}], "]"}]}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"n", "-", "aiRemote"}], "n"], 
         RowBox[{"B", "[", 
          RowBox[{"eiRemote", ",", "m"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ei", "\[Equal]", "eiRemote"}], ",", 
           RowBox[{"\[ScriptCapitalP]", "[", 
            RowBox[{"eiRemote", ",", "m"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"eiRemote", ",", "m"}], "]"}]}]}], "]"}]}]}], ")"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"eiRemote", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aiRemote", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741943387277989*^9, 3.741943590605137*^9}, {
  3.741944700527508*^9, 3.7419447081433287`*^9}, {3.7421061504348183`*^9, 
  3.7421061522181883`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"76e32ea6-3a02-4972-bd61-dcc7a6250c8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dispmad", "[", "ei_", "]"}], ":=", 
  RowBox[{"d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"eiRemote", ",", "aiRemote"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["aiRemote", "n"], 
         RowBox[{"B", "[", 
          RowBox[{"eiRemote", ",", "a"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ei", "\[Equal]", "eiRemote"}], ",", 
           RowBox[{"\[ScriptCapitalP]", "[", 
            RowBox[{"eiRemote", ",", "a"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"eiRemote", ",", "a"}], "]"}]}]}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"n", "-", "aiRemote"}], "n"], 
         RowBox[{"B", "[", 
          RowBox[{"eiRemote", ",", "m"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ei", "\[Equal]", "eiRemote"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"eiRemote", ",", "m"}], "]"}]}], ",", 
           RowBox[{"\[ScriptCapitalP]", "[", 
            RowBox[{"eiRemote", ",", "m"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
     
     RowBox[{"{", 
      RowBox[{"eiRemote", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aiRemote", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7419447158126087`*^9, 3.74194472662088*^9}, {
  3.7421061556186037`*^9, 3.742106156601686*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"4c938711-0281-4126-9848-4f2876259899"],

Cell[TextData[{
 "Probability that an adapted juvenile occupies a vacant breeding site in an \
environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "713f0f89-e3fc-432d-9d7f-d1e08f4e418c"],
 "-patch previously containing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "b58269ec-1148-4adf-85a5-74b8948f37ff"],
 " adapted breeders:"
}], "Text",
 CellChangeTimes->{{3.74194260013247*^9, 
  3.741942644172921*^9}},ExpressionUUID->"bf1bbc5f-b555-4137-87b5-\
fc2d6e97fc71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotal", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"localad", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], "+", 
   RowBox[{"dispad", "[", "ei", "]"}], "+", 
   RowBox[{"localmad", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], "+", 
   RowBox[{"dispmad", "[", "ei", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741944392305044*^9, 3.741944399732643*^9}, {
  3.7419446121438713`*^9, 3.74194461905276*^9}, {3.7419447302477617`*^9, 
  3.741944734644456*^9}, {3.741944773956568*^9, 3.741944774687063*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a6f132f3-f9ec-45eb-986a-de771f6a37db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ap", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"localad", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}], "+", 
      RowBox[{"dispad", "[", "ei", "]"}]}], ")"}], "/", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741942614820899*^9, 3.741942686589384*^9}, {
  3.7421046547062407`*^9, 3.742104656977347*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"ce4c5cdc-c76e-4091-886c-4d4b48148f0e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Patch Frequencies", "Section",
 CellChangeTimes->{{3.7403912087491827`*^9, 3.740391214765005*^9}, {
  3.741941596699419*^9, 3.741941599520822*^9}, {3.741941746178463*^9, 
  3.741941754508333*^9}, {3.742031648875845*^9, 
  3.74203164915551*^9}},ExpressionUUID->"3eaf8f25-2c41-47ab-91d9-\
3dc93905d7e4"],

Cell[TextData[{
 "Continuous-time change in frequency  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["e", "i"], ",", 
     SubscriptBox["a", "i"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "a545e44e-0d8d-4396-ae3e-07a796195e0c"],
 " of patches in environmental state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "c757a36b-fdb7-4e63-8368-12fb5a1201af"],
 " containing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "8804c996-352d-4fb4-b234-0e283779a57f"],
 " adapted breeders"
}], "Text",
 CellChangeTimes->{{3.740391268438595*^9, 3.740391310215631*^9}, {
  3.741941871276482*^9, 3.741941890762267*^9}, {3.7419422804416103`*^9, 
  3.741942283685669*^9}},ExpressionUUID->"1132a434-49fe-48eb-97f5-\
d2a6713d3156"],

Cell[CellGroupData[{

Cell["Differential equations of patch frequencies", "Subsection",
 CellChangeTimes->{{3.741945085395915*^9, 
  3.741945110883896*^9}},ExpressionUUID->"23a01af5-b38f-4e21-ac05-\
15f357c2bcfc"],

Cell[TextData[{
 "1: Patch frequency change due to environmental change, which is the \
difference between the frequency of patches switching from state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "j"], TraditionalForm]],ExpressionUUID->
  "a4fb6893-4d2d-44b2-9050-b45d9cc4b7fa"],
 " to state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "3091120e-8b56-4b4b-af5b-c4d6a41f6fac"],
 " (at rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", 
    SubscriptBox["e", "j"]], TraditionalForm]],ExpressionUUID->
  "a3bb4d0c-dd4b-4998-b03c-dc534e8cadfc"],
 ") and the frequency of patches switching from state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "152b67a8-ff0b-4aef-9390-349102fd94aa"],
 " to state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "j"], TraditionalForm]],ExpressionUUID->
  "4e6bbc88-fc2b-4a14-9199-74b3611fa2a7"],
 " (at rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", 
    SubscriptBox["e", "i"]], TraditionalForm]],ExpressionUUID->
  "a81516b7-76a7-45ec-971f-f8065feb628c"],
 ")"
}], "Text",
 CellChangeTimes->{{3.741941644508353*^9, 3.741941655996482*^9}, {
  3.7419421222604933`*^9, 3.741942220492742*^9}, {3.7419422876209927`*^9, 
  3.741942288637196*^9}},ExpressionUUID->"fe109fb2-7383-4aa6-93a5-\
eb84bf36ac68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt1", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"s", " ", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", 
      RowBox[{"n", "-", "ai"}]}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"s", "[", "ei", "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7403913220154533`*^9, 3.7403913395750017`*^9}, {
  3.7419414923165197`*^9, 3.741941504020821*^9}, {3.741941638884749*^9, 
  3.741941672164834*^9}, {3.741942274187071*^9, 3.741942275437105*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"c250ef06-db64-4802-bc5c-7b1b0c5623bf"],

Cell[TextData[{
 "2: Patch frequency changes from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "-", "1"}], TraditionalForm]],ExpressionUUID->
  "2b4922df-d0c8-4e3c-8df1-84151a42a69e"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "062c6a68-70e1-4d1c-a071-63b1c68dbeea"],
 " due to mortality of a maladapted individual replaced by an adapted \
individual. Note that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], ">", "0"}], TraditionalForm]],ExpressionUUID->
  "dd14bdc8-ec9e-46b7-bf1c-3547a1e920f3"],
 ", otherwise ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "i"], "-", "1"}], "<", "0"}], TraditionalForm]],
  ExpressionUUID->"a006d219-244c-4cc3-a386-f0d2787bf95b"],
 ". "
}], "Text",
 CellChangeTimes->{{3.7419416796379547`*^9, 3.7419416946363363`*^9}, {
  3.741941950707283*^9, 3.741941952812491*^9}, {3.7419422902153387`*^9, 
  3.741942308437057*^9}, {3.741942359700823*^9, 3.741942559844797*^9}, {
  3.741944857780445*^9, 
  3.741944858134469*^9}},ExpressionUUID->"b267a78d-809d-44bd-ae99-\
af0eef29a748"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt2", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"ai", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"(", 
        RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "-", "1"}]}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741942110182776*^9, 3.741942116476818*^9}, {
  3.741942256324829*^9, 3.741942271741022*^9}, {3.741942323949608*^9, 
  3.7419423533394623`*^9}, {3.741942388845656*^9, 3.7419424073490667`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d89db7b0-d870-4eb2-9c8a-b96783dc6ced"],

Cell[TextData[{
 "3: Patch frequency changes from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "+", "1"}], TraditionalForm]],ExpressionUUID->
  "44d3eb7d-8357-414e-8939-c0eade2de157"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "9a54e244-7c61-4622-9a00-4173bd98de29"],
 " due to mortality of an adapted individual replaced by a maladapted \
individual."
}], "Text",
 CellChangeTimes->{{3.741944818652055*^9, 
  3.741944860245799*^9}},ExpressionUUID->"6311c37f-94b3-4ed9-a02e-\
86fd8a3aff42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt3", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"ai", "<", "n"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ai", "+", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"ap", "[", 
        RowBox[{"ei", ",", 
         RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741944861237338*^9, 3.7419449147401543`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"23380dac-dc57-4b94-b58a-39310372a0d5"],

Cell[TextData[{
 "4: Patch frequency changes from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "0f1b32a9-ded7-486d-877b-fc5cef867e7b"],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "+", "1"}], TraditionalForm]],ExpressionUUID->
  "2e774c0e-29cb-4eae-9b1f-34a6c02886cc"],
 " due to mortality of a maladapted individual replaced by an adapted \
individual"
}], "Text",
 CellChangeTimes->{{3.741945001363708*^9, 
  3.741945029864462*^9}},ExpressionUUID->"73d1a1df-cd16-40c7-be8a-\
8e62bf7d26c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt4", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"n", "-", "ai"}], ")"}]}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   RowBox[{"ap", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741945031293044*^9, 3.7419450673961887`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"88f0d85e-5ddb-431a-9a3c-f688d2db1407"],

Cell[TextData[{
 "5: Patch frequency changes from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "0c58fc23-4341-4ce4-a1a3-bf63e39ccbde"],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "-", "1"}], TraditionalForm]],ExpressionUUID->
  "7bda5789-4008-4469-8473-fdab48e1711b"],
 " due to mortality of an adapted individual replaced by a maladapted \
individual"
}], "Text",
 CellChangeTimes->{{3.741944917299788*^9, 
  3.7419449702924833`*^9}},ExpressionUUID->"776ce47b-007e-48e2-8352-\
62ecbe7a4c70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt5", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "ai"}], " ", 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7419449499689302`*^9, 3.741944997652918*^9}, {
  3.741945043204258*^9, 3.741945072117237*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"efb35826-d7fe-4efb-b97c-bf508f0c67d4"],

Cell["Overall patch frequency change:", "Text",
 CellChangeTimes->{{3.775287870224382*^9, 
  3.775287874504252*^9}},ExpressionUUID->"d34d5e51-8876-41e4-bc6e-\
bc0e3eb7ec10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dfdt1", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}], "+", 
        RowBox[{"dfdt2", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}], "+", 
        RowBox[{"dfdt3", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}], "+", 
        RowBox[{"dfdt4", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}], "+", 
        RowBox[{"dfdt5", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}],
     "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.741945119412187*^9, 3.741945178308197*^9}, 
   3.742093720348144*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"9bfd4397-efd5-4893-8315-b8715a04730d"],

Cell["Numerical solution:", "Text",
 CellChangeTimes->{{3.775287878568219*^9, 
  3.7752878836321793`*^9}},ExpressionUUID->"03915817-5e5d-4767-a9bb-\
33089ca1d61f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdt", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Variables"}]], "Input",
 CellChangeTimes->{{3.77528789538524*^9, 3.775287896248296*^9}, {
  3.77528800321132*^9, 3.77528801041647*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"ce41ed20-9d1d-4ba6-89fe-c9c46ef34387"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Cm1", ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ",", "Fm1", ",", "d", ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", "Fa1", ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", "Fm2", ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "0"}], "]"}], ",", "Fa2", ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "2"}], "]"}], ",", "p2", ",", "\[Epsilon]", ",", "p1", 
   ",", "Ca1", ",", 
   RowBox[{"s", "[", "1", "]"}], ",", 
   RowBox[{"s", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7752878967946*^9, {3.7752880055737457`*^9, 3.7752880110432997`*^9}, 
   3.775288513401895*^9, 3.805624539140929*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"58a9e57d-4bde-452e-a092-98f10c5c96be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"ei", ",", "ai"}], "]"}], ",", 
       RowBox[{"N", "[", 
        RowBox[{"1", "/", "6"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ai", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.805624746343697*^9, 3.805624754820429*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"a6562104-1761-4531-996e-933b62ff0508"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0"}], "]"}], ",", "0.16666666666666666`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", "0.16666666666666666`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "0.16666666666666666`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0"}], "]"}], ",", "0.16666666666666666`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", "0.16666666666666666`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", "0.16666666666666666`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.805624750926847*^9, 3.805624755386125*^9}},
 CellLabel->"Out[29]=",ExpressionUUID->"f9975aa6-111a-4242-a90f-42a42854840f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdtNumeric", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ca1s_", ",", "Cm1s_", ",", "Ca2s_", ",", "Cm2s_"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"Fa1s_", ",", "Fm1s_", ",", "Fa2s_", ",", "Fm2s_"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"p1s_", ",", "p2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "\[Epsilon]s_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"dfdt", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
       RowBox[{"Ca1", "\[Rule]", "Ca1s"}], ",", 
       RowBox[{"Cm1", "\[Rule]", "Cm1s"}], ",", 
       RowBox[{"Ca2", "\[Rule]", "Ca2s"}], ",", 
       RowBox[{"Cm2", "\[Rule]", "Cm2s"}], ",", 
       RowBox[{"Fa1", "\[Rule]", "Fa1s"}], ",", 
       RowBox[{"Fm1", "\[Rule]", "Fm1s"}], ",", 
       RowBox[{"Fa2", "\[Rule]", "Fa2s"}], ",", 
       RowBox[{"Fm2", "\[Rule]", "Fm2s"}], ",", 
       RowBox[{"p1", "\[Rule]", "p1s"}], ",", 
       RowBox[{"p2", "\[Rule]", "p2s"}], ",", 
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "\[Epsilon]s"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"ei", ",", "ai"}], "]"}], ",", 
          RowBox[{"N", "[", 
           RowBox[{"1", "/", "6"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ai", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.775287886967115*^9, 3.775288106649271*^9}, {
  3.775288519890669*^9, 3.775288580009796*^9}, {3.805624695179613*^9, 
  3.805624698929975*^9}, {3.8056247585041857`*^9, 3.805624769260013*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"03b7a9a2-f19b-4ee1-b4e6-b52f01e910ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dfdtNumeric", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.0398107", ",", "0.0398107"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "2.0", ",", "1.0", ",", "2.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "1.0", ",", "1.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25", ",", "0.01"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7752881089835653`*^9, 3.775288128856585*^9}, {
   3.7752898104522038`*^9, 3.775289840489359*^9}, 3.7752901744794283`*^9, {
   3.805624512829266*^9, 3.805624513009251*^9}, {3.805624549300317*^9, 
   3.805624579446128*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"eec8f658-3edf-45a3-8f5d-3405b84aba02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", "0.04529071292780039`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "0.17149872834817784`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0.16666666666666596`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", "0.04529071292780053`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0.17149872834817845`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0.16666666666666666`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.805624539231154*^9, 3.8056245805435877`*^9, 
  3.805624701364008*^9, 3.805624772210387*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"76f5912a-edfe-4327-979e-c0ac61ce3250"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Reproductive values", "Section",
 CellChangeTimes->{{3.741941772404159*^9, 3.7419417748042917`*^9}, {
  3.742031651772066*^9, 
  3.7420316519394093`*^9}},ExpressionUUID->"4ace0643-5eb6-40eb-87e4-\
b29ecfe4d15f"],

Cell[TextData[{
 "Let v(ei,a,aother) reflect the reproductive value of a focal adult breeder \
living in an environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "6f5b8642-a23c-468c-8d94-5604197b35b3"],
 " patch, while in state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "e8916c36-d790-4c1a-b97f-7ee320ca23e1"],
 " (adapted, maladapted):"
}], "Text",
 CellChangeTimes->{{3.741945308811945*^9, 3.7419453611400642`*^9}, {
  3.741945407036186*^9, 
  3.74194540773237*^9}},ExpressionUUID->"47133672-5b8e-45bc-a53c-\
96498f564fa5"],

Cell[CellGroupData[{

Cell["3.1: Some auxiliary functions", "Subsection",
 CellChangeTimes->{{3.741948627543603*^9, 3.7419486308892193`*^9}, {
  3.742031675844098*^9, 
  3.742031677027319*^9}},ExpressionUUID->"eb6a25c5-821b-41a9-af5c-\
9a813fc496e1"],

Cell["\<\
Probability that any local, yet nonfocal breeder produces a successfully \
established adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.7419487609108973`*^9, 
  3.741948780848559*^9}},ExpressionUUID->"06107e8a-0944-4c45-97ce-\
8cb0df010ca9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localadother", "[", 
   RowBox[{"ei_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["aother", "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "a"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "aother", "-", "1"}], "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741948785928691*^9, 3.74194882983171*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"8c97e4e4-ef88-4e50-805b-43d63f727449"],

Cell["\<\
Probability that any local, yet nonfocal breeder produces a successfully \
established maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.741948843727401*^9, 
  3.7419488478252897`*^9}},ExpressionUUID->"f035f00e-9685-4638-b339-\
e2fb2d8426b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localmadother", "[", 
   RowBox[{"ei_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["aother", "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "aother", "-", "1"}], "n"], 
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "m"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741948855375326*^9, 3.7419488641356897`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"55a34c53-b525-46d6-96e6-90bc4ffe2888"],

Cell["\<\
Probability that any breeder but the focal produces a successfully \
established adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.741948682047*^9, 3.7419487034494333`*^9}, {
  3.741948783294915*^9, 
  3.7419487837611103`*^9}},ExpressionUUID->"2e8510c9-d8a6-478d-93f9-\
3bcff565316d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"apother", "[", 
   RowBox[{"ei_", ",", "aother_", ",", "atotal_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"localadother", "[", 
      RowBox[{"ei", ",", "aother"}], "]"}], "+", 
     RowBox[{"dispad", "[", "ei", "]"}]}], ")"}], "/", 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"ei", ",", "atotal"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741948631808817*^9, 3.741948635091099*^9}, {
  3.741948705638968*^9, 3.741948757439269*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"1dc40c75-bf89-4f0f-b0ea-b214e6b06b07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mpother", "[", 
   RowBox[{"ei_", ",", "aother_", ",", "atotal_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"localmadother", "[", 
      RowBox[{"ei", ",", "aother"}], "]"}], "+", 
     RowBox[{"dispmad", "[", "ei", "]"}]}], ")"}], "/", 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"ei", ",", "atotal"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741948879517247*^9, 3.741948907183332*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"198dcdbd-9020-4c01-8f8f-9655258784f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.2: Differential equations of reproductive values (RV)", "Subsection",
 CellChangeTimes->{{3.7419452582839117`*^9, 3.7419452721720953`*^9}, {
  3.7420316783954687`*^9, 
  3.7420316798033857`*^9}},ExpressionUUID->"e6cc1f3b-402c-4d61-a0a5-\
aee878c94405"],

Cell["1: \[CapitalDelta]v due to environmental switching", "Text",
 CellChangeTimes->{{3.741945267372336*^9, 
  3.741945301652104*^9}},ExpressionUUID->"3c425b98-f571-48c7-a1e5-\
fb6565acaf40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt1", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", 
       RowBox[{"switchAd", "[", "aself", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "-", "aother"}]}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7419417829621277`*^9, 3.74194183038861*^9}, {
   3.7419452870362463`*^9, 3.7419452970441113`*^9}, {3.741945369068324*^9, 
   3.7419453759005203`*^9}, {3.7419512780086317`*^9, 3.741951280366152*^9}, 
   3.7530024422289124`*^9, {3.7752855888829613`*^9, 3.775285589040472*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"e1aa4b17-8470-431d-b8b1-58674e32c47c"],

Cell["\<\
2: \[CapitalDelta]v due to death of the focal adult breeder, replaced by \
focal\[CloseCurlyQuote]s own offspring of a different type than focal \
(replacement of focal\[CloseCurlyQuote]s offspring of same type results in \
\[CapitalDelta]v=0, due to asexual inheritance).\
\>", "Text",
 CellChangeTimes->{{3.741945381419938*^9, 
  3.741945451084428*^9}},ExpressionUUID->"90265f89-0872-4868-9fc0-\
6cbc73d74720"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt2", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   FractionBox["1", "n"], 
   FractionBox[
    RowBox[{
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "aself"}], "]"}], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "aself"}], "]"}]}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", 
      RowBox[{
       RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"switchAd", "[", "aself", "]"}], ",", "aother"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.741945452556885*^9, 3.741945541172421*^9}, {
   3.741945667076633*^9, 3.741945726029188*^9}, {3.7419458504453707`*^9, 
   3.7419458773974447`*^9}, {3.741949143856969*^9, 3.741949148688343*^9}, {
   3.741949179408855*^9, 3.7419491804726553`*^9}, 3.7530024385116243`*^9, {
   3.77528558740331*^9, 3.775285587560308*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"7a866ae9-3413-4dc7-b5ed-c45a44dce730"],

Cell["\<\
3: \[CapitalDelta]v due to death of focal adult breeder, replaced by nonfocal \
offspring\
\>", "Text",
 CellChangeTimes->{{3.741945818988133*^9, 
  3.7419458292926483`*^9}},ExpressionUUID->"fa1b7dd4-749a-4e03-8d3a-\
9d4cc8da127c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt3", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      FractionBox["1", "n"], 
      FractionBox[
       RowBox[{"B", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}], 
       RowBox[{"localcomptotal", "[", 
        RowBox[{"ei", ",", 
         RowBox[{
          RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], 
        "]"}]]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.74194583073755*^9, 3.7419458993342648`*^9}, 
   3.753002433253241*^9, {3.775285585898892*^9, 3.775285586064417*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"79ff492b-8d88-44e0-8d0c-ea40fbb1f546"],

Cell["\<\
4: \[CapitalDelta]v due to death of nonfocal maladapted breeder in local \
patch, replaced by focal offspring of same type as focal\
\>", "Text",
 CellChangeTimes->{{3.741945903132265*^9, 3.741945926270817*^9}, {
  3.741946053631874*^9, 
  3.741946056068822*^9}},ExpressionUUID->"e11be682-8bb0-4109-8ee8-\
c7eb444e557b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt4", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", "<", 
     RowBox[{"n", "-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "aother", "-", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     FractionBox[
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{
         RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "aself", ",", 
          RowBox[{"aother", "+", 
           RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741945932496759*^9, 3.7419461028454247`*^9}, {
   3.741946148062008*^9, 3.741946149521409*^9}, {3.741946281654015*^9, 
   3.741946289605522*^9}, {3.7419491173053617`*^9, 3.741949118711915*^9}, {
   3.742029229724875*^9, 3.742029233524623*^9}, 3.742029604438162*^9, {
   3.753002423565028*^9, 3.7530024272185783`*^9}, {3.7752855842831306`*^9, 
   3.775285584456602*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"c0c50ef9-8901-4855-b9d5-862938cdef65"],

Cell["\<\
5: \[CapitalDelta]v due to death of nonfocal maladapted breeder in local \
patch, replaced by focal offspring of different type than focal\
\>", "Text",
 CellChangeTimes->{{3.741946117100341*^9, 
  3.741946134756805*^9}},ExpressionUUID->"cc8d0610-97ef-4fce-90af-\
cdca86b24f68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt5", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", "<", 
     RowBox[{"n", "-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "aother", "-", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     FractionBox[
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{
         RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "aself"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", 
         RowBox[{"switchAd", "[", "aself", "]"}], ",", 
         RowBox[{"aother", "+", 
          RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}], "+", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "+", 
          RowBox[{"countAd", "[", 
           RowBox[{"switchAd", "[", "aself", "]"}], "]"}]}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741945932496759*^9, 3.7419461028454247`*^9}, {
   3.741946151205043*^9, 3.741946220668996*^9}, {3.741946300157555*^9, 
   3.7419463086852093`*^9}, {3.741949121616023*^9, 3.741949124033033*^9}, {
   3.741952176970208*^9, 3.741952178225436*^9}, {3.742029214764893*^9, 
   3.742029215828438*^9}, 3.742029595047224*^9, {3.753002363408827*^9, 
   3.7530023647657843`*^9}, 3.775286003066927*^9},
 CellLabel->
  "In[243]:=",ExpressionUUID->"98f9885a-dbec-428f-b5dd-b6df675af507"],

Cell["\<\
6: \[CapitalDelta]v due to death of a nonfocal maladapted breeder in local \
patch, replaced by nonfocal offspring that is adapted (replacement of a \
nonfocal maladapted by a nonfocal maladapted offspring results in \
\[CapitalDelta]v=0).\
\>", "Text",
 CellChangeTimes->{{3.741948454558319*^9, 3.741948500469689*^9}, {
  3.741948539895287*^9, 
  3.741948564607822*^9}},ExpressionUUID->"e02756c3-6689-4716-8dd5-\
e594abdf9bc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt6", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", "<", 
     RowBox[{"n", "-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "aother", "-", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"apother", "[", 
      RowBox[{"ei", ",", "aother", ",", 
       RowBox[{"aother", "+", 
        RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "+", "1"}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7419485015789833`*^9, 3.741948525815185*^9}, {
  3.741948573317083*^9, 3.7419486207201242`*^9}, {3.74202920710021*^9, 
  3.742029208332275*^9}, {3.74211025963511*^9, 3.7421102682663*^9}, {
  3.753002353756806*^9, 3.753002357566009*^9}, {3.775285556529739*^9, 
  3.7752855577838373`*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"f97c18e1-b84f-44f3-a178-be527784a34f"],

Cell["\<\
7: \[CapitalDelta]v due to death of a nonfocal adapted breeder in local \
patch, replaced by focal offspring of same type than focal\
\>", "Text",
 CellChangeTimes->{{3.7419462353642273`*^9, 3.741946255925091*^9}, {
  3.741948447656364*^9, 3.741948448734859*^9}, {3.74194931166383*^9, 
  3.741949312197941*^9}, {3.7419495198626738`*^9, 
  3.741949520271603*^9}},ExpressionUUID->"b9d03845-0df9-49f9-95f3-\
a8e22f326ec9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt7", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", ">", "0"}], ",", 
    RowBox[{"aother", " ", 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"aother", "+", 
         RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "aself", ",", 
          RowBox[{"aother", "-", "1", "+", 
           RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.74194842461115*^9, 3.741948450180028*^9}, {
  3.741949013143639*^9, 3.741949013454897*^9}, {3.741949054823689*^9, 
  3.74194910919363*^9}, {3.741949209161551*^9, 3.741949278542211*^9}, {
  3.753002351415757*^9, 3.753002352043943*^9}, {3.775285558985979*^9, 
  3.775285559448605*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"d6e9473d-2b75-44f6-b691-234dee06da73"],

Cell["\<\
8: \[CapitalDelta]v due to death of a nonfocal adapted breeder in  a local \
patch, replaced by focal offspring of a different type than focal\
\>", "Text",
 CellChangeTimes->{{3.741949281414935*^9, 3.7419493187761993`*^9}, {
  3.741949522350905*^9, 
  3.7419495225501842`*^9}},ExpressionUUID->"16f288ac-605c-4932-bdb2-\
3da299ec8755"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt8", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", ">", "0"}], ",", 
    RowBox[{"aother", " ", 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"aother", "+", 
         RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], 
     RowBox[{"\[ScriptCapitalP]", "[", 
      RowBox[{"ei", ",", "aself"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", 
         RowBox[{"switchAd", "[", "aself", "]"}], ",", 
         RowBox[{"aother", "-", "1", "+", 
          RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}], "+", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "-", "1", "+", 
          RowBox[{"countAd", "[", 
           RowBox[{"switchAd", "[", "aself", "]"}], "]"}]}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741949324904705*^9, 3.741949389687532*^9}, {
   3.753002348736026*^9, 3.7530023496779203`*^9}, 3.775286006138628*^9},
 CellLabel->
  "In[246]:=",ExpressionUUID->"fbe0dbf3-4ee1-4716-b7fd-919406231d2f"],

Cell["\<\
9: \[CapitalDelta]v due to death of a nonfocal adapted breeder in a local \
patch, replaced by nonfocal maladapted offspring \
\>", "Text",
 CellChangeTimes->{{3.74194944566374*^9, 3.7419494481988583`*^9}, {
  3.741949511463278*^9, 
  3.741949570686966*^9}},ExpressionUUID->"6944212a-ec6b-486f-9c6a-\
f0f8e31e6dae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt9", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", ">", "0"}], ",", 
    RowBox[{"aother", " ", 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"mpother", "[", 
      RowBox[{"ei", ",", "aother", ",", 
       RowBox[{"aother", "+", 
        RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "-", "1"}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7419495731514072`*^9, 3.7419496367845707`*^9}, {
  3.7419501062158823`*^9, 3.741950106687559*^9}, {3.753002345795927*^9, 
  3.753002346652924*^9}, {3.7752855627615213`*^9, 3.775285562912187*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"bdec7b0a-ee36-4aec-b838-d2a8f68b3a62"],

Cell["10: \[CapitalDelta]v due to death of a maladapted breeder in remote \
patch", "Text",
 CellChangeTimes->{{3.74194964019835*^9, 3.741949662146709*^9}, {
  3.741949984654627*^9, 
  3.741949984856724*^9}},ExpressionUUID->"4d5357b0-4d0b-4c5f-b871-\
12dbdd9c5600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt10", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"eiRemote", ",", "aiRemote"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"n", "-", "aiRemote"}], ")"}], 
      RowBox[{"M", "[", 
       RowBox[{"eiRemote", ",", "m"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", "aself", ",", 
             RowBox[{"switchAd", "[", "aself", "]"}]}], "]"}], ",", 
           "aiRemote"}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"\[ScriptCapitalP]", "[", 
           RowBox[{"ei", ",", "aself"}], "]"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", 
             RowBox[{"switchAd", "[", "aself", "]"}], ",", "aself"}], "]"}], 
           ",", "aiRemote"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"eiRemote", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aiRemote", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.74194966370138*^9, 3.741949962932404*^9}, {
  3.7419500174478607`*^9, 3.741950028209113*^9}, {3.753002229651113*^9, 
  3.753002231617333*^9}, {3.775285570730752*^9, 3.775285571808795*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"fe14c7de-3453-4b89-94ae-1f8a8c146272"],

Cell["11: \[CapitalDelta]v due to death of an adapted breeder in remote \
patch", "Text",
 CellChangeTimes->{{3.74194964019835*^9, 3.741949662146709*^9}, {
  3.741949977998489*^9, 
  3.741949982871263*^9}},ExpressionUUID->"04500271-4f8f-414d-b814-\
ee5620fc4047"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt11", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"eiRemote", ",", "aiRemote"}], "]"}], "aiRemote", " ", 
      RowBox[{"M", "[", 
       RowBox[{"eiRemote", ",", "a"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", "aself", ",", 
             RowBox[{"switchAd", "[", "aself", "]"}]}], "]"}], ",", 
           RowBox[{"aiRemote", "-", "1"}]}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"\[ScriptCapitalP]", "[", 
           RowBox[{"ei", ",", "aself"}], "]"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", 
             RowBox[{"switchAd", "[", "aself", "]"}], ",", "aself"}], "]"}], 
           ",", 
           RowBox[{"aiRemote", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"eiRemote", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aiRemote", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.74194966370138*^9, 3.7419499928796997`*^9}, {
  3.741950033801907*^9, 3.741950086105291*^9}, {3.741951312495469*^9, 
  3.741951317487771*^9}, {3.753002224662657*^9, 3.753002227580731*^9}, {
  3.775285568322567*^9, 3.77528557630459*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"26e16617-c394-487e-9e55-b4a8a89a8dd3"],

Cell["Total \[CapitalDelta]V:", "Text",
 CellChangeTimes->{{3.74195021022269*^9, 
  3.7419502166702223`*^9}},ExpressionUUID->"c96d40c8-387f-4af3-9ad7-\
2594f08bcecc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdt", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dvdt1", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt2", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt3", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt4", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt5", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt6", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt7", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt8", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt9", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt10", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvdt11", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741950116957943*^9, 3.741950192719083*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"cda6ddaa-0ccf-4407-8513-8aaf01687287"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdtTable", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"dvdt", "[", 
       RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aself", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aother", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7419502436901207`*^9, 3.741950282743001*^9}, {
  3.7421105883065853`*^9, 3.742110588625523*^9}, {3.7421113790188103`*^9, 
  3.742111379713718*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"ebd604a5-8db8-4534-938b-d16af18d138c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.3: Constraint on dimensionality: the average RV = 1", "Subsection",
 CellChangeTimes->{{3.7419514085984383`*^9, 3.741951415558845*^9}, {
  3.742031681107685*^9, 3.742031681915401*^9}, {3.7420383356673107`*^9, 
  3.742038356787846*^9}, {3.762761972304812*^9, 
  3.762761988313342*^9}},ExpressionUUID->"be191d2c-aa93-44ee-8c08-\
1c932bfd74d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vtotal", "=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["ai", "n"], 
       RowBox[{"f", "[", 
        RowBox[{"ei", ",", "ai"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", 
         RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"n", "-", "ai"}], "n"], 
       RowBox[{"f", "[", 
        RowBox[{"ei", ",", "ai"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "ai"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}], "-", 
   "1"}]}]], "Input",
 CellChangeTimes->{{3.741951445543795*^9, 3.74195151880007*^9}, {
   3.742038331164031*^9, 3.742038331348621*^9}, 3.7420383663584223`*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"298bbd7c-a900-4235-a229-74d650501c4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "a", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "2"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "a", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "m", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "m", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "1"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "a", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "2"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "a", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "m", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "1"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "m", ",", "1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.7419515197347107`*^9, 3.7420226295965548`*^9, 3.742026198230379*^9, 
   3.742026322392325*^9, 3.742029286112617*^9, 3.742029611359326*^9, 
   3.7420305906631203`*^9, 3.742031578077755*^9, 3.742033429436899*^9, 
   3.742035061090557*^9, 3.742036661477488*^9, 3.742037965474134*^9, {
   3.7420383595294437`*^9, 3.742038366861629*^9}, 3.742040845254287*^9, 
   3.74204163183127*^9, 3.742041663662731*^9, 3.742089026270968*^9, 
   3.742089274029311*^9, 3.7420899005315437`*^9, 3.742091291879087*^9, 
   3.742091398872607*^9, 3.7420918223672113`*^9, 3.742092074382856*^9, 
   3.742092368216354*^9, 3.742093512128882*^9, 3.742106234341371*^9, 
   3.7421065371071463`*^9, 3.742108947992509*^9, 3.742109657505954*^9, 
   3.742110591668243*^9, 3.742110671793605*^9, 3.742116603615389*^9, 
   3.7421169922801733`*^9, 3.7421185162316732`*^9, 3.742118779983862*^9, 
   3.752870971563287*^9, 3.752997468474824*^9, 3.753002679404084*^9, 
   3.753264606609548*^9, 3.7627623212567263`*^9, 3.76276240738552*^9, 
   3.7638046546957283`*^9, 3.763810393271729*^9, 3.775284976605345*^9, 
   3.775285607401691*^9, 3.77528601736023*^9, 3.7752885137347097`*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"13f88933-1b8e-4fea-8efb-ec036419f1f3"]
}, Open  ]],

Cell[TextData[{
 "Total \[CapitalDelta]RV of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]],ExpressionUUID->
  "91a73c7b-5671-4c3d-bee2-32b9c93a0044"],
 " parent"
}], "Text",
 CellChangeTimes->{{3.752997367961832*^9, 3.7529973765052977`*^9}, {
  3.752997514555635*^9, 
  3.752997516274489*^9}},ExpressionUUID->"8487a783-aa6b-4538-903c-\
312ae225bf4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]RVz1", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["ai", "n"], 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "ai"}], "]"}], 
       RowBox[{"dvdt", "[", 
        RowBox[{"1", ",", "a", ",", 
         RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"n", "-", "ai"}], "n"], 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "ai"}], "]"}], 
       RowBox[{"dvdt", "[", 
        RowBox[{"2", ",", "m", ",", "ai"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7529974253997726`*^9, 3.7529974383585863`*^9}, {
  3.7529975251899977`*^9, 3.752997553393744*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"2efe9320-c03c-4e27-8200-80c94c827694"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]RVz2", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["ai", "n"], 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "ai"}], "]"}], 
       RowBox[{"dvdt", "[", 
        RowBox[{"2", ",", "a", ",", 
         RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"n", "-", "ai"}], "n"], 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "ai"}], "]"}], 
       RowBox[{"dvdt", "[", 
        RowBox[{"1", ",", "m", ",", "ai"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.752997563225535*^9, 3.752997572569783*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"48774f15-1210-418e-86ca-0b3402ac1186"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. Relatedness Coefficients", "Section",
 CellChangeTimes->{{3.742031589027542*^9, 3.742031591675762*^9}, {
  3.74203165431592*^9, 
  3.742031654443184*^9}},ExpressionUUID->"e04a848b-105f-4e6c-8f9b-\
71e804f13c96"],

Cell[CellGroupData[{

Cell["4.1: Some auxiliary functions", "Subsection",
 CellChangeTimes->{{3.742032075987255*^9, 
  3.742032083050857*^9}},ExpressionUUID->"b94fc496-f08f-427a-84c4-\
4f01cb2da7d6"],

Cell["\<\
Probability that newly established adapted breeder descends from a locally \
adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.74203209216304*^9, 
  3.742032118754318*^9}},ExpressionUUID->"83cdfd9a-989a-4a6e-aefd-\
8869e7f19bb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocala", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]], 
   FractionBox["ai", "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"\[ScriptCapitalP]", "[", 
       RowBox[{"ei", ",", "a"}], "]"}]}], ")"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]]}]}]], "Input",
 CellChangeTimes->{{3.742032122007538*^9, 3.7420321602433023`*^9}, {
  3.74203226908372*^9, 3.7420322773549232`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"34da5930-89ca-494a-8e98-24fac744f1b2"],

Cell["\<\
Probability that newly established adapted breeder descends from a locally \
maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.742032288226544*^9, 
  3.742032308058483*^9}},ExpressionUUID->"14813bbb-fb3c-45e7-b9fa-\
72898a52b048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocalm", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]], 
   FractionBox[
    RowBox[{"n", "-", "ai"}], "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   FractionBox[
    RowBox[{"\[ScriptCapitalP]", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]]}]}]], "Input",
 CellChangeTimes->{{3.7420323094868803`*^9, 3.742032327579152*^9}, 
   3.74203238121176*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"4c498c8f-f9d7-4d7b-990d-9b9a4afff0d1"],

Cell["\<\
Probability that newly established adapted breeder descends from a locally \
adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.74203209216304*^9, 
  3.742032118754318*^9}},ExpressionUUID->"d4c675ff-8ac1-484c-b800-\
4229029fb8af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocala", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]], 
   FractionBox["ai", "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   FractionBox[
    RowBox[{"\[ScriptCapitalP]", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}]]}]}]], "Input",
 CellChangeTimes->{{3.742032122007538*^9, 3.7420321602433023`*^9}, {
  3.74203226908372*^9, 3.7420322773549232`*^9}, {3.74203236117185*^9, 
  3.742032375043013*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"90efdfd4-1c59-4c8d-8d37-0359402f7a20"],

Cell["\<\
Probability that newly established adapted breeder descends from a locally \
maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.742032288226544*^9, 
  3.742032308058483*^9}},ExpressionUUID->"1526da83-ef33-465e-b2f5-\
ae3c57a44f3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocalm", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]], 
   FractionBox[
    RowBox[{"n", "-", "ai"}], "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"\[ScriptCapitalP]", "[", 
       RowBox[{"ei", ",", "m"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}]]}]}]], "Input",
 CellChangeTimes->{{3.7420323094868803`*^9, 3.742032327579152*^9}, {
  3.742032362867358*^9, 3.7420323887388487`*^9}, {3.742118482070448*^9, 
  3.742118484886218*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"f9285166-4012-42bd-84dc-b92d5a87932b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.2: Relatedness between two adapted individuals:", "Subsection",
 CellChangeTimes->{{3.7420316925932426`*^9, 3.7420317029133472`*^9}, {
  3.7420318339074707`*^9, 3.742031835475445*^9}, {3.742032069531159*^9, 
  3.742032069610849*^9}, {3.742035122565467*^9, 
  3.742035122733396*^9}},ExpressionUUID->"667e89cb-83a7-402b-af53-\
09262e6d67fb"],

Cell["4.2.1: \[CapitalDelta]r due to environmental change", "Text",
 CellChangeTimes->{{3.742031761699685*^9, 3.742031771483294*^9}, {
  3.7420318692512283`*^9, 3.742031872379274*^9}, {3.742036176732778*^9, 
  3.7420361789565353`*^9}},ExpressionUUID->"95719fd8-8ffe-4528-a708-\
0821e19a109d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]raa1", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", 
     RowBox[{"n", "-", "ai"}]}], "]"}], 
   RowBox[{"rmm", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", 
     RowBox[{"n", "-", "ai"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742031772867023*^9, 3.742031858187483*^9}, {
  3.742031936515861*^9, 3.7420319373230457`*^9}, {3.742031975716168*^9, 
  3.742031980651576*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"7f2f9453-f9b0-4d75-ac82-eeda3e110932"],

Cell[TextData[{
 "4.2.2: \[CapitalDelta]r from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "-", "1"}], TraditionalForm]],ExpressionUUID->
  "61327105-3499-42ac-9e3a-263c3774d9e0"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "8c2671e2-773f-4ffa-a478-62f96499ea15"],
 " due to mortality of a maladapted adult, replaced by adapted adult"
}], "Text",
 CellChangeTimes->{{3.742031865198512*^9, 3.7420319290110073`*^9}, {
  3.742032573667008*^9, 3.7420325799309187`*^9}, {3.742036182568556*^9, 
  3.742036184926282*^9}},ExpressionUUID->"f7cb039a-bd22-4b65-8606-\
543fc0ddfb48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]raa2", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", 
     RowBox[{"(", 
      RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   RowBox[{"ap", "[", 
    RowBox[{"ei", ",", 
     RowBox[{"ai", "-", "1"}]}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", 
     RowBox[{"ai", "-", "1"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"ai", "-", "2"}], ")"}], "2"], 
      RowBox[{"raa", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["2", "ai"], 
      RowBox[{"afromlocala", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"ai", "-", "1"}]], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"ai", "-", "2"}], 
          RowBox[{"ai", "-", "1"}]], 
         RowBox[{"raa", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "-", "1"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"afromlocalm", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}], 
      RowBox[{"ram", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.742031932141253*^9, 3.742032061451901*^9}, {
  3.742032434900071*^9, 3.742032526883829*^9}, {3.742032687092464*^9, 
  3.7420326948675823`*^9}, {3.7420923596963177`*^9, 3.7420923601809807`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"7e8cc5e8-f854-420e-aa88-736c59ffb33c"],

Cell["\<\
4.2.3: \[CapitalDelta]r due to mortality of an adapted individual, replaced \
by an adapted individual\
\>", "Text",
 CellChangeTimes->{{3.7420325588187523`*^9, 3.742032589778089*^9}, {
  3.74203618836624*^9, 
  3.742036189381042*^9}},ExpressionUUID->"3bf216b9-4fe1-440e-bffc-\
2368c175b791"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]raa3", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"ai", " ", 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   RowBox[{"ap", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"ai", "-", "2"}], "ai"], 
      RowBox[{"raa", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["2", "ai"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"afromlocala", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "ai"], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"ai", "-", "1"}], "ai"], 
            RowBox[{"raa", "[", 
             RowBox[{"ei", ",", "ai"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"afromlocalm", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.742032591245082*^9, 3.742032683419693*^9}, {
  3.742033290643589*^9, 3.742033291020342*^9}, {3.74209233835703*^9, 
  3.7420923465010757`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"305e470f-cffb-4a91-959c-eedd2aede7fb"],

Cell["\<\
4.2.4: \[CapitalDelta]r due to mortality of a maladapted individual, replaced \
by a maladapted individual\
\>", "Text",
 CellChangeTimes->{{3.74203269949852*^9, 3.74203274273835*^9}, {
  3.742036191045849*^9, 
  3.742036193324688*^9}},ExpressionUUID->"098eacbb-17e8-4434-8335-\
aa1b66330082"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]raa4", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", "ai"}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"raa", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742032743944285*^9, 3.742032764635002*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"80f4c4c8-6b10-4032-b5f9-20d2a1508a7c"],

Cell[TextData[{
 "4.2.5: \[CapitalDelta]r from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "+", "1"}], TraditionalForm]],ExpressionUUID->
  "7a03b81e-c988-4147-909d-fd0a0ddc8673"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "fb938b26-98eb-448e-9a90-5ecf17baa7fe"],
 " due to mortality of an adapted individual and replacement by a maladapted \
individual"
}], "Text",
 CellChangeTimes->{{3.742032784498857*^9, 3.742032788348116*^9}, {
  3.742033043932474*^9, 3.742033076282639*^9}, {3.742036197031395*^9, 
  3.7420361979567842`*^9}},ExpressionUUID->"e1046d72-a957-4fc0-bb47-\
95f52fd838be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]raa5", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"ai", "<", "n"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ai", "+", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"ap", "[", 
        RowBox[{"ei", ",", 
         RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "+", "1"}]}], "]"}], 
     RowBox[{"raa", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.742033077997287*^9, 3.7420331476269493`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"27a7ef0d-3c3a-42f9-a70d-5e8b46faec7d"],

Cell["\<\
4.2.6: Get the denominator (the rates leading to changes in 1-5):\
\>", "Text",
 CellChangeTimes->{{3.7420331713463783`*^9, 3.7420332060509853`*^9}, {
  3.742036200829783*^9, 
  3.742036203372923*^9}},ExpressionUUID->"4532774d-16c0-49e4-925e-\
2ec868daaae6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]raadenom", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", 
      RowBox[{"n", "-", "ai"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", 
      RowBox[{"(", 
       RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", 
      RowBox[{"ai", "-", "1"}]}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", 
      RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
   RowBox[{"ai", " ", 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "ai"}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ai", "<", "n"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ai", "+", "1"}], ")"}], 
      RowBox[{"M", "[", 
       RowBox[{"ei", ",", "a"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"ap", "[", 
         RowBox[{"ei", ",", 
          RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
      RowBox[{"f", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742033163909238*^9, 3.742033233762789*^9}, {
  3.7420333169571953`*^9, 3.742033360789564*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"d7ad594b-e842-4737-836f-60236c70c203"],

Cell["4.2.7: Full table of relatedness coefficients", "Text",
 CellChangeTimes->{{3.742036166692719*^9, 
  3.7420361732451077`*^9}},ExpressionUUID->"c6df52a7-0e5b-4fa6-9c16-\
63ee45b79b39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"raatab", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"raa", "[", 
        RowBox[{"ei", ",", "ai"}], "]"}], "\[Equal]", 
       FractionBox[
        RowBox[{
         RowBox[{"\[CapitalDelta]raa1", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]raa2", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]raa3", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]raa4", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]raa5", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}], 
        RowBox[{"\[CapitalDelta]raadenom", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ai", ",", "2", ",", "n"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74203315891719*^9, 3.7420331600666447`*^9}, {
  3.7420333634596987`*^9, 3.742033434603718*^9}, {3.742091378159058*^9, 
  3.742091382718123*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"f11d8651-9961-40bd-a8fc-bf9ef7154ca3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3: Relatedness between two maladapted individuals:", "Subsection",
 CellChangeTimes->{{3.742033455385066*^9, 3.742033474864997*^9}, {
  3.7420351089573507`*^9, 
  3.7420351101731453`*^9}},ExpressionUUID->"78fcf983-0dc3-4cae-a06a-\
1bdefd0bfe27"],

Cell["4.3.1: \[CapitalDelta]r due to environmental change", "Text",
 CellChangeTimes->{{3.742033919531825*^9, 
  3.742033931723833*^9}},ExpressionUUID->"e48045d9-ef5e-462c-ae7d-\
5efb063bf048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]rmm1", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", 
     RowBox[{"n", "-", "ai"}]}], "]"}], 
   RowBox[{"raa", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", 
     RowBox[{"n", "-", "ai"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742033477444257*^9, 3.742033482113385*^9}, {
  3.742033934084558*^9, 3.742033956973138*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"08df377a-b9cb-4797-b90c-848a9ba3dc51"],

Cell[TextData[{
 "4.3.2: \[CapitalDelta]r from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "-", "1"}], TraditionalForm]],ExpressionUUID->
  "779827e1-da14-4c6d-a44e-62d62b3e33bb"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "b821416c-781c-42a9-ad4d-d9ad3ee6388a"],
 " due to replacement of maladapted by adapted breeder"
}], "Text",
 CellChangeTimes->{{3.7420339601078672`*^9, 
  3.742034017740315*^9}},ExpressionUUID->"031af172-d828-40b4-9ba0-\
dee398f6b072"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]rmm2", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"ai", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"(", 
        RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "-", "1"}]}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "-", "1"}]}], "]"}], 
     RowBox[{"rmm", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.742034018897258*^9, 3.7420340649725113`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"110a719a-6e7b-45bb-b2ed-eed6ee0c0e8c"],

Cell["\<\
4.3.3: \[CapitalDelta]r due to death of adapted breeder and replacement by \
adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.742034067956318*^9, 
  3.742034102403616*^9}},ExpressionUUID->"db2d3be8-dcc0-4ee8-8c90-\
34c7e96939eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]rmm3", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"ai", " ", 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   RowBox[{"ap", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"rmm", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742034103412216*^9, 3.742034141980599*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"d584aeb7-cb68-43e2-ba18-54b1fb1075ef"],

Cell["\<\
4.3.4: \[CapitalDelta]r due to death of maladapted breeder and replacement by \
maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.74203414842799*^9, 
  3.742034169380109*^9}},ExpressionUUID->"c03b8363-c900-4f7f-a4fb-\
461420407a0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]rmm4", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", "ai"}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"n", "-", "ai", "-", "2"}], ")"}], 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"rmm", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["2", 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mfromlocala", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mfromlocalm", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"n", "-", "ai"}]], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", "ai", "-", "1"}], 
             RowBox[{"n", "-", "ai"}]], 
            RowBox[{"rmm", "[", 
             RowBox[{"ei", ",", "ai"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.742034433741946*^9, 3.742034524997941*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"c7e79035-8f9a-4a51-a878-a63c48ce13b0"],

Cell[TextData[{
 "4.3.5: \[CapitalDelta]r from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "+", "1"}], TraditionalForm]],ExpressionUUID->
  "5fc9fb3f-889a-4f99-b891-69f09c77befd"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "2958df92-9fc6-45b8-9bc7-b54b19c49634"],
 " due to death of adapted breeder and replacement by maladapted breeder"
}], "Text",
 CellChangeTimes->{{3.742034528500581*^9, 
  3.742034559300375*^9}},ExpressionUUID->"c38ff9f4-7847-47a4-aa8e-\
62706555c084"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]rmm5", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ai", "+", "1"}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", 
     RowBox[{"ai", "+", "1"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"n", "-", "ai", "-", "2"}], 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"rmm", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "+", "1"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["2", 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mfromlocala", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "+", "1"}]}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "+", "1"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mfromlocalm", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "+", "1"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"ai", "+", "1"}], ")"}]}]], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"ai", "+", "1"}], ")"}], "-", "1"}], 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"ai", "+", "1"}], ")"}]}]], 
            RowBox[{"rmm", "[", 
             RowBox[{"ei", ",", 
              RowBox[{"ai", "+", "1"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.742034700317415*^9, 3.7420349074861717`*^9}, {
  3.742034991118661*^9, 3.742034991462535*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"20463dcf-7294-475c-81ec-8d4c33f61d96"],

Cell["4.3.6: denominator of total \[CapitalDelta]r", "Text",
 CellChangeTimes->{{3.742034925333165*^9, 
  3.7420349325656967`*^9}},ExpressionUUID->"cf62a804-d2e2-4b23-a08b-\
d3dcb64ef0db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]rmmdenom", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", 
      RowBox[{"n", "-", "ai"}]}], "]"}]}], "+", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ai", ">", "0"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"(", 
         RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
      RowBox[{"M", "[", 
       RowBox[{"ei", ",", "m"}], "]"}], 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}], 
      RowBox[{"f", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], "+", 
   RowBox[{"ai", " ", 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "ai"}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ai", "+", "1"}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", 
      RowBox[{"ai", "+", "1"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.742034933882533*^9, 3.742035000480304*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"7b8710ef-6d6c-4d27-828a-c3ff5f69543f"],

Cell["4.3.7: Full table of relatedness coefficients", "Text",
 CellChangeTimes->{{3.742036150093017*^9, 
  3.742036159693368*^9}},ExpressionUUID->"8c999201-9d8d-472d-8f2d-\
dc487088ba1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rmmtab", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"rmm", "[", 
        RowBox[{"ei", ",", "ai"}], "]"}], "\[Equal]", 
       FractionBox[
        RowBox[{
         RowBox[{"\[CapitalDelta]rmm1", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]rmm2", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]rmm3", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]rmm4", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]rmm5", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}], 
        RowBox[{"\[CapitalDelta]rmmdenom", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ai", ",", "0", ",", 
        RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7420350044953213`*^9, 3.742035071678275*^9}, {
  3.742091386135157*^9, 3.742091387575873*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"9cdcc93d-cc5b-4a86-b454-f93b8ca30359"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.4: Relatedness between adapted and maladapted individuals:", \
"Subsection",
 CellChangeTimes->{{3.742035090357279*^9, 
  3.742035118157373*^9}},ExpressionUUID->"f446b308-1029-4335-80a1-\
cdd8ceece6a9"],

Cell["4.4.1: \[CapitalDelta]r due to environmental change", "Text",
 CellChangeTimes->{{3.742035139453229*^9, 
  3.742035150093227*^9}},ExpressionUUID->"9984ca26-82ad-4ee9-abe7-\
9e7c8042af71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]ram1", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", 
     RowBox[{"n", "-", "ai"}]}], "]"}], 
   RowBox[{"ram", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", 
     RowBox[{"n", "-", "ai"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.742035153378587*^9, 3.742035182798193*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"d0e894ac-96c8-4919-a160-5d026c9147a7"],

Cell[TextData[{
 "4.4.2: \[CapitalDelta]r from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "95222d9d-6467-485e-921f-2b2d871d50a0"],
 "-1 to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "641e4e77-ec0f-4558-933c-1786b15e07a5"],
 " due to death of maladapted breeder and replacement by adapted breeder"
}], "Text",
 CellChangeTimes->{{3.742035186140995*^9, 3.742035190333465*^9}, {
  3.742035220773282*^9, 
  3.742035240733417*^9}},ExpressionUUID->"4464e006-5e6c-48a2-8c94-\
ac0c0c4cddda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]ram2", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", 
     RowBox[{"(", 
      RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   RowBox[{"ap", "[", 
    RowBox[{"ei", ",", 
     RowBox[{"ai", "-", "1"}]}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", 
     RowBox[{"ai", "-", "1"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"ai", "-", "1"}], "ai"], 
      RowBox[{"ram", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "ai"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"afromlocala", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "-", "1"}]}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"afromlocalm", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "-", "1"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"ai", "-", "1"}], ")"}]}]], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"ai", "-", "1"}], ")"}], "-", "1"}], 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"ai", "-", "1"}], ")"}]}]], 
            RowBox[{"rmm", "[", 
             RowBox[{"ei", ",", 
              RowBox[{"ai", "-", "1"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7420352418340073`*^9, 3.742035294357746*^9}, {
  3.742035333022387*^9, 3.74203539270278*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"4883df4e-61fb-461f-a1ca-6ab486736b0d"],

Cell["\<\
4.4.3: \[CapitalDelta]r due to death of adapted and replacement by adapted \
breeder\
\>", "Text",
 CellChangeTimes->{{3.7420353984215*^9, 
  3.742035427644971*^9}},ExpressionUUID->"f29227aa-7eb0-4caf-b90e-\
973a1b10e293"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]ram3", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{"ai", " ", 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   RowBox[{"ap", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"ai", "-", "1"}], "ai"], 
      RowBox[{"ram", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "ai"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"afromlocala", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"afromlocalm", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"n", "-", "ai"}]], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", "ai", "-", "1"}], 
             RowBox[{"n", "-", "ai"}]], 
            RowBox[{"rmm", "[", 
             RowBox[{"ei", ",", "ai"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7420354293946333`*^9, 3.742035560134203*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"f83a743d-0a08-4c9f-a11b-bf7818e59131"],

Cell["\<\
4.4.4: \[CapitalDelta]r due to death of maladapted and replacement by \
maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.742035570085664*^9, 3.7420355845493813`*^9}, {
  3.7420357789731827`*^9, 
  3.742035779925308*^9}},ExpressionUUID->"ac509b1a-91bb-4fc0-89ce-\
d60c4f36fb3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]ram4", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "-", "ai"}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "m"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "ai"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"n", "-", "ai", "-", "1"}], 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"ram", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mfromlocala", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "ai"], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"ai", "-", "1"}], "ai"], 
            RowBox[{"raa", "[", 
             RowBox[{"ei", ",", "ai"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"mfromlocalm", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.742035593437952*^9, 3.742035597117589*^9}, {
  3.742035628805729*^9, 3.742035724107538*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"241a5fbc-114e-42fa-afac-c29bef1409c5"],

Cell[TextData[{
 "4.4.5: \[CapitalDelta]r from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "+", "1"}], TraditionalForm]],ExpressionUUID->
  "c8d00691-2a63-4de0-a38c-2bbe817cf137"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "5b85c7ec-d86c-4a93-ba85-97eb6e1c2fef"],
 " due to replacement of adapted by maladapted breeder"
}], "Text",
 CellChangeTimes->{{3.742035731340824*^9, 
  3.742035777029492*^9}},ExpressionUUID->"b40f7355-25cf-42ad-825d-\
e31a07e35593"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]ram5", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ai", "+", "1"}], ")"}], 
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "a"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"ap", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", 
     RowBox[{"ai", "+", "1"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"n", "-", "ai", "-", "1"}], 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"ram", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "+", "1"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"n", "-", "ai"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mfromlocala", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "+", "1"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"ai", "+", "1"}]], "+", 
           RowBox[{
            FractionBox["ai", 
             RowBox[{"ai", "+", "1"}]], 
            RowBox[{"raa", "[", 
             RowBox[{"ei", ",", 
              RowBox[{"ai", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"mfromlocalm", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "+", "1"}]}], "]"}], 
         RowBox[{"ram", "[", 
          RowBox[{"ei", ",", 
           RowBox[{"ai", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.742035790648726*^9, 3.742035925022779*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"4bcae745-01c7-455a-b482-67c63ae27bf9"],

Cell["4.4.6: denominator of total \[CapitalDelta]r", "Text",
 CellChangeTimes->{{3.742035934428483*^9, 
  3.7420359435732803`*^9}},ExpressionUUID->"4f8e575a-8808-4dc6-8273-\
05dee77bb867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]ramdenom", "[", 
   RowBox[{"ei_", ",", "ai_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", 
      RowBox[{"n", "-", "ai"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", 
      RowBox[{"(", 
       RowBox[{"ai", "-", "1"}], ")"}]}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", 
      RowBox[{"ai", "-", "1"}]}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", 
      RowBox[{"ai", "-", "1"}]}], "]"}]}], "+", 
   RowBox[{"ai", " ", 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], 
    RowBox[{"ap", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "ai"}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", "ai"}], "]"}]}], ")"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "ai"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ai", "+", "1"}], ")"}], 
    RowBox[{"M", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"ai", "+", "1"}]}], "]"}]}], ")"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", 
      RowBox[{"ai", "+", "1"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.742035945481224*^9, 3.74203599422471*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"e64d468f-16dd-4184-9003-17795e02efdd"],

Cell["4.4.7: Full table of relatedness coefficients", "Text",
 CellChangeTimes->{{3.742036129548785*^9, 
  3.742036137725197*^9}},ExpressionUUID->"79a8d045-f0c5-4c14-8450-\
1c1a632f37ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ramtab", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ram", "[", 
        RowBox[{"ei", ",", "ai"}], "]"}], "\[Equal]", 
       FractionBox[
        RowBox[{
         RowBox[{"\[CapitalDelta]ram1", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]ram2", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]ram3", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]ram4", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}], "+", 
         RowBox[{"\[CapitalDelta]ram5", "[", 
          RowBox[{"ei", ",", "ai"}], "]"}]}], 
        RowBox[{"\[CapitalDelta]ramdenom", "[", 
         RowBox[{"ei", ",", "ai"}], "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ai", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.742036022150419*^9, 3.742036072581896*^9}, {
  3.742091390694509*^9, 3.742091422300043*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"bb17b323-b160-4870-9d3d-f225d81ca4f1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["5. Selection Gradients", "Section",
 CellChangeTimes->{{3.7419515606228228`*^9, 3.7419515679297733`*^9}, {
  3.7420316567318773`*^9, 
  3.742031658891251*^9}},ExpressionUUID->"7d0cfb07-7814-46d0-b62e-\
65a9d9fc2790"],

Cell[TextData[{
 "Let v(ei,a,aother) reflect the reproductive value of a focal adult breeder \
living in an environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],ExpressionUUID->
  "e9c46053-9cec-4449-824e-d33d878b7888"],
 " patch, while in state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "d"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "m"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "2ee976c8-5aeb-4523-be28-71f0c8f72a8c"],
 " (adapted, maladapted):"
}], "Text",
 CellChangeTimes->{{3.741945308811945*^9, 3.7419453611400642`*^9}, {
  3.741945407036186*^9, 
  3.74194540773237*^9}},ExpressionUUID->"e372e46b-9961-4054-88d3-\
a8c0e94635e5"],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.742030620013184*^9, 
  3.7420306219967947`*^9}},ExpressionUUID->"1a91c2b8-1882-4692-b3c2-\
5b3f19967f70"],

Cell["\<\
Probability that an adapted offspring from a nonfocal individual successfully \
establishes itself in the local site\
\>", "Text",
 CellChangeTimes->{{3.742031165069502*^9, 
  3.7420311955415583`*^9}},ExpressionUUID->"964e4d74-fe5a-40d0-bb75-\
86ce6e1ff424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"apother\[Delta]", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", 
      RowBox[{
       RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["aother", "n"], 
         RowBox[{"B", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ScriptCapitalP]", "[", 
              RowBox[{"ei", ",", "a"}], "]"}], "+", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"countAd", "[", "aself", "]"}], "\[Equal]", "1"}], 
                ",", 
                RowBox[{"raa", "[", 
                 RowBox[{"ei", ",", 
                  RowBox[{"aother", "+", "1"}]}], "]"}], ",", 
                RowBox[{"ram", "[", 
                 RowBox[{"ei", ",", "aother"}], "]"}]}], "]"}], 
              RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
               RowBox[{"ei", ",", "a"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"n", "-", "1", "-", "aother"}], "n"], 
         RowBox[{"B", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ScriptCapitalP]", "[", 
            RowBox[{"ei", ",", "m"}], "]"}], "+", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"countAd", "[", "aself", "]"}], "\[Equal]", "1"}], ",", 
              RowBox[{"ram", "[", 
               RowBox[{"ei", ",", 
                RowBox[{"aother", "+", "1"}]}], "]"}], ",", 
              RowBox[{"rmm", "[", 
               RowBox[{"ei", ",", "aother"}], "]"}]}], "]"}], 
            RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "m"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"dispad", "[", "ei", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.742030674311816*^9, 3.742030717653694*^9}, {
  3.742030978014777*^9, 3.742031159918251*^9}, {3.742031219646731*^9, 
  3.74203122159865*^9}, {3.742036292310422*^9, 3.7420362987426167`*^9}, {
  3.7420363406381083`*^9, 3.7420364216222973`*^9}, {3.742036476998756*^9, 
  3.742036477806617*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"2af2a3c4-eae6-41d3-9e03-add23f809912"],

Cell["\<\
Probability that a maladapted offspring from a nonfocal individual \
successfully establishes itself in the local site\
\>", "Text",
 CellChangeTimes->{{3.742031165069502*^9, 
  3.742031206317664*^9}},ExpressionUUID->"6200b4a4-7a56-47f8-bd72-\
91cf235101de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mpother\[Delta]", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", 
      RowBox[{
       RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["aother", "n"], 
         RowBox[{"B", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ScriptCapitalP]", "[", 
            RowBox[{"ei", ",", "a"}], "]"}], "+", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"countAd", "[", "aself", "]"}], "\[Equal]", "1"}], ",", 
              RowBox[{"raa", "[", 
               RowBox[{"ei", ",", 
                RowBox[{"aother", "+", "1"}]}], "]"}], ",", 
              RowBox[{"ram", "[", 
               RowBox[{"ei", ",", "aother"}], "]"}]}], "]"}], 
            RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "a"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"n", "-", "1", "-", "aother"}], "n"], 
         RowBox[{"B", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ScriptCapitalP]", "[", 
              RowBox[{"ei", ",", "m"}], "]"}], "+", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"countAd", "[", "aself", "]"}], "\[Equal]", "1"}], 
                ",", 
                RowBox[{"ram", "[", 
                 RowBox[{"ei", ",", 
                  RowBox[{"aother", "+", "1"}]}], "]"}], ",", 
                RowBox[{"rmm", "[", 
                 RowBox[{"ei", ",", "aother"}], "]"}]}], "]"}], 
              RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
               RowBox[{"ei", ",", "m"}], "]"}]}]}], ")"}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"dispmad", "[", "ei", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.742030674311816*^9, 3.742030717653694*^9}, {
  3.742030978014777*^9, 3.742031159918251*^9}, {3.742031201958611*^9, 
  3.742031237054553*^9}, {3.7420365283296843`*^9, 3.742036563881423*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"950fbd1f-00e5-456a-b759-d6f78180c451"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Reproductive-value weighted effects due to a slight change \[Delta]\
\[ScriptCapitalP] in phenotype switching\
\>", "Subsection",
 CellChangeTimes->{{3.7419452582839117`*^9, 3.7419452721720953`*^9}, {
  3.741951773808332*^9, 
  3.741951801448374*^9}},ExpressionUUID->"40cfade3-c292-4776-90ff-\
5e0975441f56"],

Cell["\<\
Selection is expressed as the change in reproductive value due to a slight \
mutant. Hence, we need to assess those \[CapitalDelta]vs from the previous \
section which involve \[ScriptCapitalP], which are items 2, 4, 5, 6, 7, 8, 9, \
10, 11\
\>", "Text",
 CellChangeTimes->{{3.741951934999291*^9, 3.741951948407916*^9}, {
  3.741951982353063*^9, 3.7419520854393997`*^9}, {3.7419521305921717`*^9, 
  3.741952132304781*^9}, {3.741952193976593*^9, 3.7419522153926277`*^9}, {
  3.7419522747847433`*^9, 3.741952278000393*^9}, {3.7420312725900173`*^9, 
  3.7420312731494427`*^9}, {3.742031428589157*^9, 3.742031430764309*^9}, {
  3.7420315404284163`*^9, 
  3.7420315407160673`*^9}},ExpressionUUID->"a852afc3-b0c6-4d05-ba9d-\
f663784e9b52"],

Cell["\<\
2: \[CapitalDelta]v-weighted change due to death of the focal adult breeder, \
replaced by focal\[CloseCurlyQuote]s own offspring of a different type than \
focal (replacement of focal\[CloseCurlyQuote]s offspring of same type results \
in \[CapitalDelta]v=0, due to asexual inheritance).\
\>", "Text",
 CellChangeTimes->{{3.741945381419938*^9, 3.741945451084428*^9}, {
  3.74195181943987*^9, 3.741951825272047*^9}, {3.7419520666321697`*^9, 
  3.741952067024379*^9}},ExpressionUUID->"87efc7c4-e6c4-43a5-b3ba-\
6eed808ae11f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]1", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   FractionBox["1", "n"], 
   FractionBox[
    RowBox[{
     RowBox[{"B", "[", 
      RowBox[{"ei", ",", "aself"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}], "+", 
       RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}]}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"ei", ",", 
      RowBox[{
       RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"switchAd", "[", "aself", "]"}], ",", "aother"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.741945452556885*^9, 3.741945541172421*^9}, {
  3.741945667076633*^9, 3.741945726029188*^9}, {3.7419458504453707`*^9, 
  3.7419458773974447`*^9}, {3.741949143856969*^9, 3.741949148688343*^9}, {
  3.741949179408855*^9, 3.7419491804726553`*^9}, {3.7419517259367523`*^9, 
  3.741951739153393*^9}, {3.741951809209895*^9, 3.74195183858515*^9}, {
  3.741952112103997*^9, 3.741952112282384*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"c9c7e578-cdf2-427d-a15f-b91612330649"],

Cell["\<\
4: \[CapitalDelta]v due to death of nonfocal maladapted breeder in local \
patch, replaced by focal offspring of same type as focal\
\>", "Text",
 CellChangeTimes->{{3.741945903132265*^9, 3.741945926270817*^9}, {
  3.741946053631874*^9, 
  3.741946056068822*^9}},ExpressionUUID->"5ae122ef-2ef8-41de-b42d-\
649f525d81f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]2", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", "<", 
     RowBox[{"n", "-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "aother", "-", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     FractionBox[
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{
         RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalP]", "[", 
          RowBox[{"ei", ",", "aself"}], "]"}], "+", 
         RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
          RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "aself", ",", 
          RowBox[{"aother", "+", 
           RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741945932496759*^9, 3.7419461028454247`*^9}, {
  3.741946148062008*^9, 3.741946149521409*^9}, {3.741946281654015*^9, 
  3.741946289605522*^9}, {3.7419491173053617`*^9, 3.741949118711915*^9}, {
  3.7419520902166443`*^9, 3.741952115817862*^9}, {3.74195215576862*^9, 
  3.741952155843624*^9}, {3.7420291920042562`*^9, 3.74202919349253*^9}, {
  3.742029539333309*^9, 3.7420295629569197`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"04634f8f-c623-41bb-bf33-82154a6227d8"],

Cell["\<\
5: \[CapitalDelta]v due to death of nonfocal maladapted breeder in local \
patch, replaced by focal offspring of different type than focal\
\>", "Text",
 CellChangeTimes->{{3.741946117100341*^9, 
  3.741946134756805*^9}},ExpressionUUID->"8a3bbe99-3537-4f15-8adc-\
c73704c2e98a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]3", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", "<", 
     RowBox[{"n", "-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "aother", "-", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     FractionBox[
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{
         RowBox[{"countAd", "[", "aself", "]"}], "+", "aother"}]}], "]"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}], "+", 
       RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", 
         RowBox[{"switchAd", "[", "aself", "]"}], ",", 
         RowBox[{"aother", "+", 
          RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}], "+", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "+", 
          RowBox[{"countAd", "[", 
           RowBox[{"switchAd", "[", "aself", "]"}], "]"}]}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741945932496759*^9, 3.7419461028454247`*^9}, {
  3.741946151205043*^9, 3.741946220668996*^9}, {3.741946300157555*^9, 
  3.7419463086852093`*^9}, {3.741949121616023*^9, 3.741949124033033*^9}, {
  3.741952146769395*^9, 3.741952159129479*^9}, {3.742029186878439*^9, 
  3.7420291888846292`*^9}, {3.742029571597672*^9, 3.742029574085197*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"d1ea68d7-e001-48ab-b018-86e8dae453d8"],

Cell["\<\
6: \[CapitalDelta]v due to death of nonfocal maladapted breeder in local \
patch, replaced by nonfocal offspring of a different type than nonfocal\
\>", "Text",
 CellChangeTimes->{{3.742031327132864*^9, 
  3.742031346996435*^9}},ExpressionUUID->"2fa9c834-ef70-4ba6-bf30-\
b9684e4acce7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]4", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", "<", 
     RowBox[{"n", "-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "aother", "-", "1"}], ")"}], 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], 
     RowBox[{"apother\[Delta]", "[", 
      RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "+", "1"}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.742031356966111*^9, 3.74203141477318*^9}, {
  3.742031492396875*^9, 3.7420314931647053`*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"95c8a060-0090-4859-9813-4237d96f2a66"],

Cell["\<\
7: \[CapitalDelta]v due to death of a nonfocal adapted breeder in local \
patch, replaced by focal offspring of same type than focal\
\>", "Text",
 CellChangeTimes->{{3.7419462353642273`*^9, 3.741946255925091*^9}, {
  3.741948447656364*^9, 3.741948448734859*^9}, {3.74194931166383*^9, 
  3.741949312197941*^9}, {3.7419495198626738`*^9, 
  3.741949520271603*^9}},ExpressionUUID->"7fe619b5-db8a-4cc2-92e3-\
010a4a1262e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]5", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", ">", "0"}], ",", 
    RowBox[{"aother", " ", 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"aother", "+", 
         RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalP]", "[", 
          RowBox[{"ei", ",", "aself"}], "]"}], "+", 
         RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
          RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "aself", ",", 
          RowBox[{"aother", "-", "1", "+", 
           RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.74194842461115*^9, 3.741948450180028*^9}, {
  3.741949013143639*^9, 3.741949013454897*^9}, {3.741949054823689*^9, 
  3.74194910919363*^9}, {3.741949209161551*^9, 3.741949278542211*^9}, {
  3.74195221916469*^9, 3.741952242362052*^9}, {3.74203142392599*^9, 
  3.7420314240289583`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"634a3010-5ded-4ec4-bdcf-932c369b9a67"],

Cell["\<\
8: \[CapitalDelta]v due to death of a nonfocal adapted breeder in  a local \
patch, replaced by focal offspring of a different type than focal\
\>", "Text",
 CellChangeTimes->{{3.741949281414935*^9, 3.7419493187761993`*^9}, {
  3.741949522350905*^9, 
  3.7419495225501842`*^9}},ExpressionUUID->"71505769-c420-4966-a6d2-\
f39e26b45742"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]6", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", ">", "0"}], ",", 
    RowBox[{"aother", " ", 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     FractionBox["1", "n"], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"ei", ",", "aself"}], "]"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"ei", ",", 
        RowBox[{"aother", "+", 
         RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}], "+", 
       RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
        RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", 
         RowBox[{"switchAd", "[", "aself", "]"}], ",", 
         RowBox[{"aother", "-", "1", "+", 
          RowBox[{"countAd", "[", "aself", "]"}]}]}], "]"}], "+", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "-", "1", "+", 
          RowBox[{"countAd", "[", 
           RowBox[{"switchAd", "[", "aself", "]"}], "]"}]}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.741949324904705*^9, 3.741949389687532*^9}, {
  3.741952260357038*^9, 3.74195226799251*^9}, {3.7420314370063267`*^9, 
  3.742031437212768*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"21ecfb2e-bff4-47da-98e4-d69a4dfb57ab"],

Cell["\<\
9: \[CapitalDelta]v due to death of a nonfocal adapted breeder in local \
patch, replaced by nonfocal offspring that is maladapted\
\>", "Text",
 CellChangeTimes->{{3.74203144991667*^9, 
  3.742031469068181*^9}},ExpressionUUID->"1d3083de-1241-4cce-bdd5-\
1744864b8501"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]7", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aother", ">", "0"}], ",", 
    RowBox[{"aother", " ", 
     RowBox[{"M", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], 
     RowBox[{"mpother\[Delta]", "[", 
      RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", 
         RowBox[{"aother", "-", "1"}]}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}], ")"}]}], ",", 
    "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.74203147163015*^9, 3.742031533844137*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"cad614ef-0c0b-429a-9d8a-c4c1f24619e9"],

Cell["10: \[CapitalDelta]v due to death of a maladapted breeder in remote \
patch", "Text",
 CellChangeTimes->{{3.74194964019835*^9, 3.741949662146709*^9}, {
  3.741949984654627*^9, 
  3.741949984856724*^9}},ExpressionUUID->"c02767a7-9611-4c2e-8aeb-\
cf3574d918f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]8", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"eiRemote", ",", "aiRemote"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"n", "-", "aiRemote"}], ")"}], 
      RowBox[{"M", "[", 
       RowBox[{"eiRemote", ",", "m"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ScriptCapitalP]", "[", 
               RowBox[{"ei", ",", "aself"}], "]"}], "+", 
              RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
               RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", "aself", ",", 
             RowBox[{"switchAd", "[", "aself", "]"}]}], "]"}], ",", 
           "aiRemote"}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "aself"}], "]"}], "+", 
            RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", 
             RowBox[{"switchAd", "[", "aself", "]"}], ",", "aself"}], "]"}], 
           ",", "aiRemote"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"eiRemote", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aiRemote", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.74194966370138*^9, 3.741949962932404*^9}, {
  3.7419500174478607`*^9, 3.741950028209113*^9}, {3.741952299173328*^9, 
  3.7419523306971397`*^9}, {3.742031440086432*^9, 3.74203144028542*^9}, {
  3.7420315371976633`*^9, 3.742031537380828*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"5d8293f0-3ff1-45c3-beb3-8d33102af9f9"],

Cell["11: \[CapitalDelta]v due to death of an adapted breeder in remote \
patch", "Text",
 CellChangeTimes->{{3.74194964019835*^9, 3.741949662146709*^9}, {
  3.741949977998489*^9, 
  3.741949982871263*^9}},ExpressionUUID->"00d2a7d7-b7a8-4381-9cbf-\
7d308d47cbfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]9", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "n"], 
   RowBox[{"B", "[", 
    RowBox[{"ei", ",", "aself"}], "]"}], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"eiRemote", ",", "aiRemote"}], "]"}], "aiRemote", " ", 
      RowBox[{"M", "[", 
       RowBox[{"eiRemote", ",", "a"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ScriptCapitalP]", "[", 
               RowBox[{"ei", ",", "aself"}], "]"}], "+", 
              RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
               RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", "aself", ",", 
             RowBox[{"switchAd", "[", "aself", "]"}]}], "]"}], ",", 
           RowBox[{"aiRemote", "-", "1"}]}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "aself"}], "]"}], "+", 
            RowBox[{"\[Delta]\[ScriptCapitalP]", "[", 
             RowBox[{"ei", ",", "aself"}], "]"}]}], ")"}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"eiRemote", ",", "aiRemote"}], "]"}]], 
         RowBox[{"v", "[", 
          RowBox[{"eiRemote", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eiRemote", "\[Equal]", "ei"}], ",", 
             RowBox[{"switchAd", "[", "aself", "]"}], ",", "aself"}], "]"}], 
           ",", 
           RowBox[{"aiRemote", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"eiRemote", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aiRemote", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.74194966370138*^9, 3.7419499928796997`*^9}, {
  3.741950033801907*^9, 3.741950086105291*^9}, {3.741951312495469*^9, 
  3.741951317487771*^9}, {3.741952313269821*^9, 3.741952335403054*^9}, {
  3.742031442782135*^9, 3.742031442981421*^9}, {3.742031548037232*^9, 
  3.7420315482127037`*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"13f04f9f-799d-44b8-9217-017107badc83"],

Cell["Total \[CapitalDelta]V:", "Text",
 CellChangeTimes->{{3.74195021022269*^9, 
  3.7419502166702223`*^9}},ExpressionUUID->"0081abff-b011-4ca5-8d5b-\
1de24c4d465c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]sum", "[", 
   RowBox[{"ei_", ",", "aself_", ",", "aother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dvd\[ScriptCapitalP]1", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]2", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]3", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]4", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]5", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]6", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]7", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]8", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}], "+", 
   RowBox[{"dvd\[ScriptCapitalP]9", "[", 
    RowBox[{"ei", ",", "aself", ",", "aother"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.741950116957943*^9, 3.741950192719083*^9}, {
  3.741952338033615*^9, 3.7419523841861763`*^9}, {3.742026190426633*^9, 
  3.742026190677953*^9}, {3.742031563972567*^9, 3.7420315756921387`*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"38b4154d-1fbe-4e37-8aa9-3eb58c1ae009"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd\[ScriptCapitalP]", "[", "dpval_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ai", ">", "0"}], ",", 
         RowBox[{
          FractionBox["ai", "n"], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"dvd\[ScriptCapitalP]sum", "[", 
             RowBox[{"ei", ",", "a", ",", 
              RowBox[{"ai", "-", "1"}]}], "]"}], ",", "dpval"}], "]"}]}], ",",
          "0"}], "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ai", "<", "n"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"n", "-", "ai"}], "n"], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"dvd\[ScriptCapitalP]sum", "[", 
             RowBox[{"ei", ",", "m", ",", "ai"}], "]"}], ",", "dpval"}], 
           "]"}]}], ",", "0"}], "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7419502436901207`*^9, 3.741950282743001*^9}, {
  3.74195238771243*^9, 3.741952428851181*^9}, {3.742026157874028*^9, 
  3.7420262124260178`*^9}, {3.7420263697044907`*^9, 3.7420264003216877`*^9}, {
  3.74202661853817*^9, 3.742026722555127*^9}, {3.742026790811215*^9, 
  3.742026819122773*^9}, {3.7420305862308483`*^9, 3.7420305879821053`*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"20cae176-7913-4156-b0bb-bf30248af555"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6. Exporting to C for numerical iterations", "Section",
 CellChangeTimes->{{3.691405424987905*^9, 3.691405428363462*^9}, {
  3.7420370952846727`*^9, 3.74203709806878*^9}, {3.742037246765189*^9, 
  3.742037247191476*^9}},ExpressionUUID->"86bc3695-1def-41e7-8695-\
cd90fea36a99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"directory", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/fecundity_vs_mortality/src/fecsel_p1p2/\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6914054961842823`*^9, 3.691405522712216*^9}, {
   3.691405835891177*^9, 3.691405848042817*^9}, {3.6951113605469103`*^9, 
   3.695111361719956*^9}, {3.733548457873188*^9, 3.73354845843288*^9}, {
   3.7420370722292547`*^9, 3.742037075556752*^9}, 3.742037531348649*^9, {
   3.7420912631422977`*^9, 3.742091267012884*^9}, {3.775284963927249*^9, 
   3.7752849641107397`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"c60115d9-0f72-48fe-b15a-98f8648035c3"],

Cell[CellGroupData[{

Cell["6.1: Functions", "Subsection",
 CellChangeTimes->{{3.691405580552486*^9, 3.691405583263978*^9}, {
  3.74203724919683*^9, 
  3.7420372507565947`*^9}},ExpressionUUID->"67eb85a4-fc61-4d7b-aa47-\
fd2dd47acace"],

Cell["\<\
6.1.1: export system of differential equations to C for Euler solutions:\
\>", "Text",
 CellChangeTimes->{{3.742037253245811*^9, 
  3.742037273973407*^9}},ExpressionUUID->"09254b2b-890e-48be-b548-\
7576b5a909c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportDiffRecur", "[", 
   RowBox[{
   "file_", ",", "sys_", ",", "lhs1_", ",", "lhs2_", ",", "step_", ",", 
    "Tend_", ",", "delta_", ",", "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"initialize", " ", "the", " ", "xtplus1", " ", "lhs"}], "*)"}], 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = 0;\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "for", " ", "loop", " ", "to", 
       " ", "iterate", " ", "the", " ", "system"}], "*)"}], 
     RowBox[{"mainstr", "=", 
      RowBox[{
      "mainstr", "<>", "\"\<\\n\\n for (int rtime = 0; rtime < \>\"", "<>", 
       RowBox[{"ToString", "[", "Tend", "]"}], "<>", 
       "\"\<; ++rtime)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", "step", "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "delta", " ", "checking"}], 
      "*)"}], 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\nif(\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<fabs(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<)<\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "delta", "]"}], "]"}], "<>", 
          "\"\<\\n\\t\\t&& \>\""}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"erase", " ", "last"}], "&&", 
       RowBox[{"and", " ", "close", " ", "if", " ", "parentheses"}]}], "*)"}], 
     RowBox[{"mainstr", "=", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"mainstr", ",", 
         RowBox[{
          RowBox[{"StringLength", "[", "mainstr", "]"}], "-", "3"}]}], "]"}], 
       "<>", "\"\<)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       "*)"}], 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"end", " ", "if", " ", "statement"}], "*)"}], 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n\\t break;\\n}\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       "*)"}], 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"end", " ", "for", " ", "loop"}], "*)"}], 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n}\\n\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6914054491388702`*^9, 3.69140549223973*^9}, 
   3.6914056037172956`*^9, {3.691407158464012*^9, 3.691407175858728*^9}, {
   3.742037235515266*^9, 3.7420372367335577`*^9}, {3.7420372784188747`*^9, 
   3.742037297061234*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"db4052d6-4109-46af-8977-cf688a16f494"],

Cell["6.1.2: main recursion of the selection gradients", "Text",
 CellChangeTimes->{{3.742037321245798*^9, 3.742037332229628*^9}, {
  3.742037382701357*^9, 
  3.742037385500908*^9}},ExpressionUUID->"3df7ad44-e343-44be-8410-\
0d5fc0e130ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mainrecursion", "[", 
   RowBox[{
   "file_", ",", "lhs1_", ",", "lhs2_", ",", "sys_", ",", "step_", ",", 
    "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "boundfunc", "]"}], "]"}], "<>", "\"\<(\>\"",
           "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "step", "]"}], "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<));\\n\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.742037306783943*^9, {3.742037390206882*^9, 3.742037394616838*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"1f71ac4c-fdce-4f10-b40b-2a6aad358e4d"],

Cell["\<\
6.1.3: export the variables (i.e., the variables that change at the \
ecological or evolutionary timescale)\
\>", "Text",
 CellChangeTimes->{{3.742037396940015*^9, 
  3.742037424324972*^9}},ExpressionUUID->"eac960fe-7123-4a44-83a3-\
f0fab1d3aafb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportvarStruct", "[", 
   RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", ",", "iter"}], "}"}], ",", 
    RowBox[{
     RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "vars", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", 
       RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.742037403087302*^9, 3.742037427846143*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"f92c11f8-2be9-49da-a4e6-10e59d2edfb9"],

Cell["\<\
6.1.4: export the parameters (i.e., the stuff that does not change)\
\>", "Text",
 CellChangeTimes->{{3.7420374303084717`*^9, 
  3.742037450604817*^9}},ExpressionUUID->"1ccf26f5-1cb0-4e5a-b40a-\
1c77821afb44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportParamStruct", "[", 
   RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", ",", "iter"}], "}"}], ",", 
    RowBox[{
     RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "vars", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", 
       RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.74203745474126*^9},
 CellLabel->
  "In[297]:=",ExpressionUUID->"3bbbfac3-1d25-4570-bdcb-149a329968fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.2: Export Patch Frequencies", "Subsection",
 CellChangeTimes->{{3.6914056106155243`*^9, 3.691405611327383*^9}, {
  3.6914061800448313`*^9, 3.691406181859818*^9}, {3.742037459580453*^9, 
  3.742037460773161*^9}, {3.742040627545665*^9, 
  3.742040627865645*^9}},ExpressionUUID->"efdb1e39-674c-4da2-a75c-\
1ab82da8b2dc"],

Cell["Specify left-hand sides", "Text",
 CellChangeTimes->{{3.742037484916353*^9, 
  3.742037487892861*^9}},ExpressionUUID->"69842052-f990-4893-894d-\
a180424d006e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"patchfreqlhstplus1", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ftplus1", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6914058887155113`*^9, 3.691405914544606*^9}, {
  3.7420967082858677`*^9, 3.742096714132659*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"833ffd0c-96b7-49e6-9a10-d23e110bf4ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6914057213023643`*^9, {3.69140582369107*^9, 3.6914058531305723`*^9}, {
   3.691405895719328*^9, 3.691405919874858*^9}, 3.691407587594511*^9, 
   3.691410890006209*^9, 3.691411748996195*^9, 3.692697191617002*^9, 
   3.692705782210492*^9, 3.692705908428665*^9, 3.695111429080984*^9, 
   3.695111681512004*^9, 3.695112397361971*^9, 3.695112539076775*^9, 
   3.695112851304831*^9, {3.733548437323271*^9, 3.73354846205974*^9}, 
   3.742037966082501*^9, 3.742040845857613*^9, 3.742041632541361*^9, 
   3.742041664347807*^9, 3.74208990148882*^9, 3.742091293389716*^9, 
   3.742091399895763*^9, 3.742091823011792*^9, 3.742092075172268*^9, 
   3.742092369059312*^9, 3.742093512970645*^9, {3.742106235876071*^9, 
   3.742106263460423*^9}, 3.742106540511203*^9, 3.742108949134893*^9, 
   3.742118517857794*^9, 3.742118783514241*^9, 3.775284977200231*^9, 
   3.7752856081033382`*^9, 3.77528601787416*^9, 3.7752885143146152`*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"b7b7adcd-67e3-487a-a392-48ba14f12a23"]
}, Open  ]],

Cell["Specify right hand sides", "Text",
 CellChangeTimes->{{3.742037498948344*^9, 
  3.742037503524962*^9}},ExpressionUUID->"69feb794-9791-4e69-9d79-\
e4e0db398a60"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"patchfreqlhs", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", "ai"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ai", ",", "0", ",", "n"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6914058831383266`*^9, 3.691405907015476*^9}, {
  3.691406031772004*^9, 3.691406058245195*^9}, {3.742096715558003*^9, 
  3.742096718380172*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"fc09b6be-003b-4e29-93ea-bfdb7b5b14db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "0"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.691406034813655*^9, 3.6914060591739273`*^9}, 
   3.691407587630652*^9, 3.6914108900109262`*^9, 3.691411749028509*^9, 
   3.69269719162297*^9, 3.692705782251343*^9, 3.6927059084338837`*^9, 
   3.695111429085857*^9, 3.695111681518385*^9, 3.695112397415373*^9, 
   3.69511253912519*^9, 3.6951128513669777`*^9, {3.733548437360278*^9, 
   3.733548462160047*^9}, 3.742037966113778*^9, 3.7420408458939953`*^9, 
   3.7420416325785933`*^9, 3.7420416643844433`*^9, 3.742089901530912*^9, 
   3.742091293444948*^9, 3.742091399957261*^9, 3.742091823051168*^9, 
   3.742092075224098*^9, 3.742092369105105*^9, 3.742093513031309*^9, {
   3.742106235917997*^9, 3.7421062634974747`*^9}, 3.742106540602949*^9, 
   3.742108949166439*^9, 3.742118517889942*^9, 3.742118783573031*^9, 
   3.775284977233368*^9, 3.775285608159113*^9, 3.77528601791905*^9, 
   3.775288514413526*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"93cab978-c121-45d7-b2ed-84cef5bd035b"]
}, Open  ]],

Cell["Export system of patch frequency equations to C:", "Text",
 CellChangeTimes->{{3.742037506987996*^9, 
  3.7420375152291527`*^9}},ExpressionUUID->"bd46a67c-1947-415c-84ca-\
f488e94a2f76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportDiffRecur", "[", 
   RowBox[{
    RowBox[{"directory", "<>", "\"\</patchrecurs.txt\>\""}], ",", 
    RowBox[{"dfdt", "/.", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", 
      RowBox[{"1", "-", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "0"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]}]}], ",", "patchfreqlhstplus1", ",", 
    "patchfreqlhs", ",", "0.01", ",", "1000000", ",", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.691405742150585*^9, 3.691405744011664*^9}, {
  3.691406050495718*^9, 3.6914060631591597`*^9}, {3.742037637788619*^9, 
  3.742037638412477*^9}, {3.742093335766324*^9, 3.7420933623343487`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"6dedd02a-2b31-4dba-81cd-a161f1b8b308"]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.3: Export Reproductive Values", "Subsection",
 CellChangeTimes->{{3.69140621036994*^9, 3.691406210937632*^9}, {
  3.6914066827783337`*^9, 3.6914066897763042`*^9}, {3.742040624265875*^9, 
  3.742040625065289*^9}},ExpressionUUID->"e2543541-db7a-4b7b-b230-\
41c43452a459"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"repvallhstplus1", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"vtplus1", "[", 
      RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"as", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ao", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6914070124427347`*^9, {3.742041625635756*^9, 3.7420416274571857`*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"373a8966-4b52-4610-b1a3-195c04d22cd2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "a", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "a", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "m", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "m", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "a", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "a", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "m", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "m", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.691407587732304*^9, 3.691410890071251*^9, 3.691411749079719*^9, 
   3.6926971917202272`*^9, 3.6927057822993793`*^9, 3.692705908482938*^9, 
   3.695111429172662*^9, 3.69511168157073*^9, 3.695112397475758*^9, 
   3.695112539185524*^9, 3.695112851436172*^9, {3.7335484375822697`*^9, 
   3.733548462322797*^9}, 3.74203823283364*^9, 3.742040845935975*^9, {
   3.742041628623805*^9, 3.742041632634671*^9}, 3.7420416644396267`*^9, 
   3.742089901594239*^9, 3.74209129351035*^9, 3.742091400034896*^9, 
   3.742091823165956*^9, 3.74209207528656*^9, 3.7420923691640577`*^9, 
   3.742093513103544*^9, {3.742106236184752*^9, 3.742106263541813*^9}, 
   3.742106540767187*^9, 3.742108949218479*^9, 3.742118517957675*^9, 
   3.742118783684771*^9, 3.775284977272587*^9, 3.775285608214252*^9, 
   3.775286017971346*^9, 3.775288514465435*^9},
 CellLabel->
  "Out[301]=",ExpressionUUID->"fa9c64e3-12ad-4b71-a6df-edaa73def341"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"repvallhs", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"as", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ao", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6914068845866623`*^9, 3.6914068948170233`*^9}, 
   3.691407013464875*^9, {3.695112250463271*^9, 3.695112273625904*^9}, {
   3.742041658252309*^9, 3.7420416601294107`*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"6e9f2cc5-32f8-4a29-88c9-df2edf9edd79"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "a", ",", "0"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "a", ",", "1"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "m", ",", "0"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "m", ",", "1"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "a", ",", "0"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "a", ",", "1"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "m", ",", "0"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "m", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.691407587793165*^9, 3.691410890074849*^9, 3.691411749082719*^9, 
   3.692697191780066*^9, 3.6927057823045063`*^9, 3.6927059085256233`*^9, 
   3.695111429176968*^9, 3.69511168160817*^9, 3.695112397520599*^9, 
   3.695112539190874*^9, 3.695112851442205*^9, {3.733548437629731*^9, 
   3.733548462378512*^9}, 3.7420382337074747`*^9, 3.74204084594119*^9, 
   3.7420416326398983`*^9, 3.742041664444356*^9, 3.742089901599523*^9, 
   3.742091293561829*^9, 3.742091400081766*^9, 3.742091823199155*^9, 
   3.74209207534519*^9, 3.742092369225988*^9, 3.74209351316396*^9, {
   3.742106236227097*^9, 3.742106263573824*^9}, 3.742106540866892*^9, 
   3.7421089492512074`*^9, 3.7421185179913063`*^9, 3.74211878378443*^9, 
   3.775284977306283*^9, 3.775285608262106*^9, 3.775286018018664*^9, 
   3.775288514512936*^9},
 CellLabel->
  "Out[302]=",ExpressionUUID->"d1100964-2049-4e54-99fd-c5afce762e26"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{"directory", "<>", "\"\</repvals.txt\>\""}], ",", "dvdtTable", ",",
    "repvallhstplus1", ",", "repvallhs", ",", "eulrv", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound0"}], "]"}]], "Input",
 CellChangeTimes->{{3.6914069120365953`*^9, 3.6914069268670883`*^9}, {
  3.6927057697488117`*^9, 3.692705771179139*^9}, {3.692705884859172*^9, 
  3.692705887936965*^9}, {3.742038381027924*^9, 3.742038429332416*^9}, {
  3.7420898652899323`*^9, 3.7420898967197037`*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"2337d0c8-f44e-4da9-9b18-ee3acc869c2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.4: Export Relatedness Coefficients", "Subsection",
 CellChangeTimes->{{3.691406935506791*^9, 3.691406940386517*^9}, {
  3.742040629617899*^9, 
  3.742040630505199*^9}},ExpressionUUID->"8339dbb7-1234-4dff-a723-\
d7369354a45d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relvallhstplus1", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"raatplus1", "[", 
        RowBox[{"es", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ramtplus1", "[", 
        RowBox[{"es", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"rmmtplus1", "[", 
        RowBox[{"es", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0", ",", 
         RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.691406945294553*^9, 3.6914070191232777`*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"6960ed50-0ee3-4147-8adf-dcfe9a16b2d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"raatplus1", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", 
   RowBox[{"raatplus1", "[", 
    RowBox[{"2", ",", "2"}], "]"}], ",", 
   RowBox[{"ramtplus1", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"ramtplus1", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"rmmtplus1", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ",", 
   RowBox[{"rmmtplus1", "[", 
    RowBox[{"2", ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.691407587865931*^9, 3.6914108901203833`*^9, 3.691411749124524*^9, 
   3.692697191884091*^9, 3.692705782389*^9, 3.692705908600801*^9, 
   3.695111429329591*^9, 3.695111681654969*^9, 3.695112397573514*^9, 
   3.6951125392347307`*^9, 3.695112851521109*^9, {3.733548437914081*^9, 
   3.733548462558818*^9}, {3.742038448988234*^9, 3.742038457643826*^9}, 
   3.742040846000305*^9, 3.742041632700899*^9, 3.742041664505018*^9, 
   3.742089901667033*^9, 3.74209129381632*^9, 3.7420914001731367`*^9, 
   3.742091823289011*^9, 3.74209207545114*^9, 3.742092369318658*^9, 
   3.7420935132831984`*^9, {3.7421062363909807`*^9, 3.742106263660473*^9}, 
   3.742106541057086*^9, 3.7421089493519573`*^9, 3.742118518062121*^9, 
   3.7421187839716673`*^9, 3.775284977416206*^9, 3.7752856083399353`*^9, 
   3.775286018173156*^9, 3.775288514574168*^9},
 CellLabel->
  "Out[304]=",ExpressionUUID->"d641733b-be18-495a-83a2-adf2e1c7f16f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relvallhs", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"raa", "[", 
        RowBox[{"es", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ram", "[", 
        RowBox[{"es", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"rmm", "[", 
        RowBox[{"es", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0", ",", 
         RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.742038468174101*^9, 3.742038485612071*^9}, {
  3.742038533197994*^9, 3.742038562796418*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"55cd71ba-f460-412d-a59f-8023bad6b0c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"raa", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", 
   RowBox[{"raa", "[", 
    RowBox[{"2", ",", "2"}], "]"}], ",", 
   RowBox[{"ram", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"ram", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"rmm", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ",", 
   RowBox[{"rmm", "[", 
    RowBox[{"2", ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.691406990744072*^9, 3.69140702224741*^9, 3.6914075878977833`*^9, 
   3.6914108901238117`*^9, 3.691411749127226*^9, 3.6926971920083113`*^9, 
   3.692705782462879*^9, 3.6927059086036263`*^9, 3.695111429334826*^9, 
   3.6951116816895533`*^9, 3.695112397576181*^9, 3.695112539237303*^9, 
   3.695112851525022*^9, {3.733548437922885*^9, 3.733548462614586*^9}, {
   3.742038461729083*^9, 3.742038486293532*^9}, 3.7420385643349047`*^9, 
   3.742040846032989*^9, 3.7420416327381067`*^9, 3.742041664541995*^9, 
   3.7420899017083282`*^9, 3.742091293861607*^9, 3.742091400231039*^9, 
   3.7420918233326807`*^9, 3.742092075506383*^9, 3.7420923693697433`*^9, 
   3.7420935133374043`*^9, {3.7421062364334507`*^9, 3.742106263698559*^9}, 
   3.742106541147716*^9, 3.742108949391773*^9, 3.742118518103303*^9, 
   3.742118784060986*^9, 3.7752849774486732`*^9, 3.775285608381207*^9, 
   3.775286018213925*^9, 3.775288514622217*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"75f51b26-1253-4883-a81c-40ea1ef4f32c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{"directory", "<>", "\"\</relatedness.txt\>\""}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"raatab", ",", "ramtab", ",", "rmmtab"}], "]"}]}], "}"}]}], 
    "]"}], ",", "relvallhstplus1", ",", "relvallhs", ",", "0.01", ",", 
   "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.691407028248433*^9, 3.691407031054347*^9}, {
  3.691407061944549*^9, 3.6914070664230843`*^9}, {3.74203848975587*^9, 
  3.742038538436385*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"a2dc3bff-3ad0-4087-8697-d38a3c966726"]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.5: Export Selection Gradients", "Subsection",
 CellChangeTimes->{{3.6914071345660353`*^9, 3.691407140141778*^9}, {
  3.742040632881448*^9, 
  3.74204063387327*^9}},ExpressionUUID->"ba0952f0-9cb6-4232-bffe-\
f8c3c91689ea"],

Cell[BoxData[
 RowBox[{"mainrecursion", "[", 
  RowBox[{
   RowBox[{"directory", "<>", "\"\</selgrad.txt\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{"p1tplus1", ",", "p2tplus1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dvd\[ScriptCapitalP]", "[", "dp1", "]"}], ",", 
     RowBox[{"dvd\[ScriptCapitalP]", "[", "dp2", "]"}]}], "}"}], ",", "0.01", 
   ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.6914057177343903`*^9, 3.691405730628921*^9}, {
   3.691406158408965*^9, 3.69140617027407*^9}, {3.691406890738976*^9, 
   3.691406898219647*^9}, 3.691406953295332*^9, {3.6914069991452007`*^9, 
   3.691407002889412*^9}, 3.691407149204398*^9, {3.691407227433934*^9, 
   3.691407248292019*^9}, 3.691407318259791*^9, {3.691407408249332*^9, 
   3.69140740952878*^9}, {3.691407495840074*^9, 3.691407498003602*^9}, {
   3.69511165295224*^9, 3.695111676805089*^9}, {3.733548410305945*^9, 
   3.733548417160825*^9}, {3.742038582235671*^9, 3.742038586839691*^9}, 
   3.742038639477643*^9, {3.742092042080534*^9, 3.742092065886805*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"bca23f53-1456-43e3-954e-c7961904b53a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.6: Export variables and parameters", "Subsection",
 CellChangeTimes->{{3.691407257105816*^9, 3.6914072610015917`*^9}, {
  3.742040635241642*^9, 
  3.742040636273374*^9}},ExpressionUUID->"f84e47c5-4411-4203-96d3-\
03aad43da3b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "export", " ", "all", " ", "the", " ", "variables", " ", "including", " ", 
    "the", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"parameters", "=", 
     RowBox[{"{", 
      RowBox[{
      "Ca1", ",", "Ca2", ",", "Cm1", ",", "Cm2", ",", "Fa1", ",", "Fa2", ",", 
       "Fm1", ",", "Fm2", ",", "d", ",", 
       RowBox[{"s", "[", "1", "]"}], ",", 
       RowBox[{"s", "[", "2", "]"}], ",", "eulrv", ",", "\[Epsilon]"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"exportvarStruct", "[", 
    RowBox[{
     RowBox[{"directory", "<>", "\"\</variables.txt\>\""}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
      "parameters", ",", "patchfreqlhs", ",", "repvallhs", ",", "relvallhs", 
       ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"exportParamStruct", "[", 
    RowBox[{
     RowBox[{"directory", "<>", "\"\</params.txt\>\""}], ",", "parameters"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6914073386849422`*^9, 3.6914073598609123`*^9}, {
   3.691407415278714*^9, 3.691407461168558*^9}, 3.6914108797577763`*^9, {
   3.691410926942157*^9, 3.691410929164257*^9}, {3.6914117400115843`*^9, 
   3.691411740457273*^9}, {3.691411774275076*^9, 3.691411774585359*^9}, {
   3.69270589986798*^9, 3.6927059008586397`*^9}, {3.69511251643106*^9, 
   3.6951125166123657`*^9}, {3.733548407048894*^9, 3.7335484259477253`*^9}, {
   3.742038780268003*^9, 3.742038802667775*^9}, {3.7420405949474173`*^9, 
   3.742040619578376*^9}, {3.742042105296575*^9, 3.742042108215568*^9}, {
   3.742091810403104*^9, 3.742091816250511*^9}, {3.775285099778143*^9, 
   3.775285109919888*^9}, {3.7752882821871634`*^9, 3.775288297393381*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"89919226-4454-4f4b-92a5-1aef5bf51724"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1853, 1018},
WindowMargins->{{Automatic, 170}, {107, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 584, 11, 105, "Section",ExpressionUUID->"8b1b4bc5-1188-4c4a-ab88-f72346623336"],
Cell[1167, 35, 205, 4, 35, "Text",ExpressionUUID->"48eb3ed0-8865-4063-bee5-098cda380892"],
Cell[1375, 41, 217, 3, 30, "Input",ExpressionUUID->"c0e8e433-bd90-449d-8b94-7fce98fe78f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1629, 49, 209, 4, 67, "Section",ExpressionUUID->"6598478b-1cd2-4a46-830d-cfb3120b5cca"],
Cell[1841, 55, 171, 3, 35, "Text",ExpressionUUID->"e286163c-4df1-41e8-86d5-540ee303ad7f"],
Cell[2015, 60, 339, 6, 30, "Input",ExpressionUUID->"b0ecde9e-ce09-4b91-a3cb-f189b2fc0831"],
Cell[2357, 68, 716, 20, 35, "Text",ExpressionUUID->"0645c0f6-1432-48c4-9c11-84a6695cb6fc"],
Cell[3076, 90, 322, 7, 30, "Input",ExpressionUUID->"a240eeb1-723a-4a95-84b1-1c872fc6a438"],
Cell[3401, 99, 752, 24, 35, "Text",ExpressionUUID->"d833f010-487c-4732-95ec-225d51107149"],
Cell[4156, 125, 462, 13, 30, "Input",ExpressionUUID->"4cfd3550-6609-4206-b6ee-6709cf4b6812"],
Cell[4621, 140, 650, 19, 35, "Text",ExpressionUUID->"c321cee8-4dec-40db-b229-b4d73e656352"],
Cell[5274, 161, 707, 19, 30, "Input",ExpressionUUID->"c77b41d2-592b-42a3-ab87-94b1873b048f"],
Cell[5984, 182, 600, 18, 35, "Text",ExpressionUUID->"d6aed044-ed4c-495d-91e1-7bfa835233e7"],
Cell[6587, 202, 636, 18, 30, "Input",ExpressionUUID->"711b2a98-85c1-4c3c-ba0d-a1075fad111e"],
Cell[7226, 222, 784, 20, 35, "Text",ExpressionUUID->"2588f3e9-de90-47d2-8d4b-8332d0fec99a"],
Cell[8013, 244, 1679, 48, 30, "Input",ExpressionUUID->"5ccb0aea-7b91-4bf7-857d-5672feecb100"],
Cell[9695, 294, 721, 20, 35, "Text",ExpressionUUID->"b9ba38a8-32dd-4284-aac0-1eebe0534da3"],
Cell[10419, 316, 1671, 47, 30, "Input",ExpressionUUID->"9036b7b5-d830-4d6a-9874-2f381f604303"],
Cell[CellGroupData[{
Cell[12115, 367, 171, 3, 54, "Subsection",ExpressionUUID->"7229d772-9322-4f44-ac0a-9af691bad4ee"],
Cell[12289, 372, 629, 18, 35, "Text",ExpressionUUID->"67159869-9b31-4e0f-92fb-98656ddfe35e"],
Cell[12921, 392, 979, 28, 48, "Input",ExpressionUUID->"069b6de6-debc-4189-abc0-09b7ae49eb49"],
Cell[13903, 422, 631, 18, 35, "Text",ExpressionUUID->"3349bba1-448e-435e-acb0-6d3da28df85e"],
Cell[14537, 442, 1033, 28, 48, "Input",ExpressionUUID->"b54a8811-c838-4ef3-b527-a162f3f6561f"],
Cell[15573, 472, 451, 13, 35, "Text",ExpressionUUID->"08e1e047-a75e-4fd2-b71f-4f298d1e7e01"],
Cell[16027, 487, 1712, 44, 76, "Input",ExpressionUUID->"76e32ea6-3a02-4972-bd61-dcc7a6250c8a"],
Cell[17742, 533, 1661, 43, 76, "Input",ExpressionUUID->"4c938711-0281-4126-9848-4f2876259899"],
Cell[19406, 578, 564, 16, 35, "Text",ExpressionUUID->"bf1bbc5f-b555-4137-87b5-fc2d6e97fc71"],
Cell[19973, 596, 650, 14, 30, "Input",ExpressionUUID->"a6f132f3-f9ec-45eb-986a-de771f6a37db"],
Cell[20626, 612, 590, 15, 30, "Input",ExpressionUUID->"ce4c5cdc-c76e-4091-886c-4d4b48148f0e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21265, 633, 310, 5, 67, "Section",ExpressionUUID->"3eaf8f25-2c41-47ab-91d9-3dc93905d7e4"],
Cell[21578, 640, 844, 24, 35, "Text",ExpressionUUID->"1132a434-49fe-48eb-97f5-d2a6713d3156"],
Cell[CellGroupData[{
Cell[22447, 668, 191, 3, 54, "Subsection",ExpressionUUID->"23a01af5-b38f-4e21-ac05-15f357c2bcfc"],
Cell[22641, 673, 1348, 39, 40, "Text",ExpressionUUID->"fe109fb2-7383-4aa6-93a5-eb84bf36ac68"],
Cell[23992, 714, 729, 19, 30, "Input",ExpressionUUID->"c250ef06-db64-4802-bc5c-7b1b0c5623bf"],
Cell[24724, 735, 1143, 33, 35, "Text",ExpressionUUID->"b267a78d-809d-44bd-ae99-af0eef29a748"],
Cell[25870, 770, 869, 23, 30, "Input",ExpressionUUID->"d89db7b0-d870-4eb2-9c8a-b96783dc6ced"],
Cell[26742, 795, 571, 17, 35, "Text",ExpressionUUID->"6311c37f-94b3-4ed9-a02e-86fd8a3aff42"],
Cell[27316, 814, 725, 21, 30, "Input",ExpressionUUID->"23380dac-dc57-4b94-b58a-39310372a0d5"],
Cell[28044, 837, 570, 17, 35, "Text",ExpressionUUID->"73d1a1df-cd16-40c7-be8a-8e62bf7d26c5"],
Cell[28617, 856, 524, 15, 30, "Input",ExpressionUUID->"88f0d85e-5ddb-431a-9a3c-f688d2db1407"],
Cell[29144, 873, 572, 17, 35, "Text",ExpressionUUID->"776ce47b-007e-48e2-8352-62ecbe7a4c70"],
Cell[29719, 892, 580, 16, 30, "Input",ExpressionUUID->"efb35826-d7fe-4efb-b97c-bf508f0c67d4"],
Cell[30302, 910, 173, 3, 35, "Text",ExpressionUUID->"d34d5e51-8876-41e4-bc6e-bc0e3eb7ec10"],
Cell[30478, 915, 926, 25, 30, "Input",ExpressionUUID->"9bfd4397-efd5-4893-8315-b8715a04730d"],
Cell[31407, 942, 163, 3, 35, "Text",ExpressionUUID->"03915817-5e5d-4767-a9bb-33089ca1d61f"],
Cell[CellGroupData[{
Cell[31595, 949, 304, 6, 30, "Input",ExpressionUUID->"ce41ed20-9d1d-4ba6-89fe-c9c46ef34387"],
Cell[31902, 957, 862, 21, 34, "Output",ExpressionUUID->"58a9e57d-4bde-452e-a092-98f10c5c96be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32801, 983, 606, 17, 30, "Input",ExpressionUUID->"a6562104-1761-4531-996e-933b62ff0508"],
Cell[33410, 1002, 1037, 34, 34, "Output",ExpressionUUID->"f9975aa6-111a-4242-a90f-42a42854840f"]
}, Open  ]],
Cell[34462, 1039, 2199, 57, 73, "Input",ExpressionUUID->"03b7a9a2-f19b-4ee1-b4e6-b52f01e910ee"],
Cell[CellGroupData[{
Cell[36686, 1100, 767, 17, 30, "Input",ExpressionUUID->"eec8f658-3edf-45a3-8f5d-3405b84aba02"],
Cell[37456, 1119, 938, 24, 34, "Output",ExpressionUUID->"76f5912a-edfe-4327-979e-c0ac61ce3250"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38455, 1150, 220, 4, 67, "Section",ExpressionUUID->"4ace0643-5eb6-40eb-87e4-b29ecfe4d15f"],
Cell[38678, 1156, 712, 20, 35, "Text",ExpressionUUID->"47133672-5b8e-45bc-a53c-96498f564fa5"],
Cell[CellGroupData[{
Cell[39415, 1180, 228, 4, 54, "Subsection",ExpressionUUID->"eb6a25c5-821b-41a9-af5c-9a813fc496e1"],
Cell[39646, 1186, 254, 6, 35, "Text",ExpressionUUID->"06107e8a-0944-4c45-97ce-8cb0df010ca9"],
Cell[39903, 1194, 914, 27, 48, "Input",ExpressionUUID->"8c97e4e4-ef88-4e50-805b-43d63f727449"],
Cell[40820, 1223, 257, 6, 35, "Text",ExpressionUUID->"f035f00e-9685-4638-b339-e2fb2d8426b0"],
Cell[41080, 1231, 918, 27, 48, "Input",ExpressionUUID->"55a34c53-b525-46d6-96e6-90bc4ffe2888"],
Cell[42001, 1260, 296, 7, 35, "Text",ExpressionUUID->"2e8510c9-d8a6-478d-93f9-3bcff565316d"],
Cell[42300, 1269, 587, 15, 30, "Input",ExpressionUUID->"1dc40c75-bf89-4f0f-b0ea-b214e6b06b07"],
Cell[42890, 1286, 540, 14, 30, "Input",ExpressionUUID->"198dcdbd-9020-4c01-8f8f-9655258784f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43467, 1305, 260, 4, 54, "Subsection",ExpressionUUID->"e6cc1f3b-402c-4d61-a0a5-aee878c94405"],
Cell[43730, 1311, 192, 3, 35, "Text",ExpressionUUID->"3c425b98-f571-48c7-a1e5-fb6565acaf40"],
Cell[43925, 1316, 922, 23, 30, "Input",ExpressionUUID->"e1aa4b17-8470-431d-b8b1-58674e32c47c"],
Cell[44850, 1341, 422, 8, 35, "Text",ExpressionUUID->"90265f89-0872-4868-9fc0-6cbc73d74720"],
Cell[45275, 1351, 1295, 34, 51, "Input",ExpressionUUID->"7a866ae9-3413-4dc7-b5ed-c45a44dce730"],
Cell[46573, 1387, 241, 6, 35, "Text",ExpressionUUID->"fa1b7dd4-749a-4e03-8d3a-9d4cc8da127c"],
Cell[46817, 1395, 973, 29, 51, "Input",ExpressionUUID->"79ff492b-8d88-44e0-8d0c-ea40fbb1f546"],
Cell[47793, 1426, 330, 7, 35, "Text",ExpressionUUID->"e11be682-8bb0-4109-8ee8-c7eb444e557b"],
Cell[48126, 1435, 1675, 44, 51, "Input",ExpressionUUID->"c0c50ef9-8901-4855-b9d5-862938cdef65"],
Cell[49804, 1481, 288, 6, 35, "Text",ExpressionUUID->"cc8d0610-97ef-4fce-90af-cdca86b24f68"],
Cell[50095, 1489, 1870, 47, 102, "Input",ExpressionUUID->"98f9885a-dbec-428f-b5dd-b6df675af507"],
Cell[51968, 1538, 438, 9, 35, "Text",ExpressionUUID->"e02756c3-6689-4716-8dd5-e594abdf9bc5"],
Cell[52409, 1549, 1207, 31, 30, "Input",ExpressionUUID->"f97c18e1-b84f-44f3-a178-be527784a34f"],
Cell[53619, 1582, 429, 8, 35, "Text",ExpressionUUID->"b9d03845-0df9-49f9-95f3-a8e22f326ec9"],
Cell[54051, 1592, 1517, 40, 47, "Input",ExpressionUUID->"d6e9473d-2b75-44f6-b691-234dee06da73"],
Cell[55571, 1634, 345, 7, 35, "Text",ExpressionUUID->"16f288ac-605c-4932-bdb2-3da299ec8755"],
Cell[55919, 1643, 1536, 40, 96, "Input",ExpressionUUID->"fbe0dbf3-4ee1-4716-b7fd-919406231d2f"],
Cell[57458, 1685, 325, 7, 35, "Text",ExpressionUUID->"6944212a-ec6b-486f-9c6a-f0f8e31e6dae"],
Cell[57786, 1694, 1031, 26, 30, "Input",ExpressionUUID->"bdec7b0a-ee36-4aec-b838-d2a8f68b3a62"],
Cell[58820, 1722, 265, 5, 35, "Text",ExpressionUUID->"4d5357b0-4d0b-4c5f-b871-12dbdd9c5600"],
Cell[59088, 1729, 2144, 55, 168, "Input",ExpressionUUID->"fe14c7de-3453-4b89-94ae-1f8a8c146272"],
Cell[61235, 1786, 263, 5, 35, "Text",ExpressionUUID->"04500271-4f8f-414d-b814-ee5620fc4047"],
Cell[61501, 1793, 2194, 55, 168, "Input",ExpressionUUID->"26e16617-c394-487e-9e55-b4a8a89a8dd3"],
Cell[63698, 1850, 166, 3, 35, "Text",ExpressionUUID->"c96d40c8-387f-4af3-9ad7-2594f08bcecc"],
Cell[63867, 1855, 1250, 29, 52, "Input",ExpressionUUID->"cda6ddaa-0ccf-4407-8513-8aaf01687287"],
Cell[65120, 1886, 808, 22, 30, "Input",ExpressionUUID->"ebd604a5-8db8-4534-938b-d16af18d138c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65965, 1913, 349, 5, 54, "Subsection",ExpressionUUID->"be191d2c-aa93-44ee-8c08-1c932bfd74d1"],
Cell[CellGroupData[{
Cell[66339, 1922, 966, 28, 48, "Input",ExpressionUUID->"298bbd7c-a900-4235-a229-74d650501c4c"],
Cell[67308, 1952, 2639, 65, 50, "Output",ExpressionUUID->"13f88933-1b8e-4fea-8efb-ec036419f1f3"]
}, Open  ]],
Cell[69962, 2020, 378, 11, 35, "Text",ExpressionUUID->"8487a783-aa6b-4538-903c-312ae225bf4c"],
Cell[70343, 2033, 880, 25, 48, "Input",ExpressionUUID->"2efe9320-c03c-4e27-8200-80c94c827694"],
Cell[71226, 2060, 825, 24, 48, "Input",ExpressionUUID->"48774f15-1210-418e-86ca-0b3402ac1186"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72100, 2090, 220, 4, 67, "Section",ExpressionUUID->"e04a848b-105f-4e6c-8f9b-71e804f13c96"],
Cell[CellGroupData[{
Cell[72345, 2098, 177, 3, 54, "Subsection",ExpressionUUID->"b94fc496-f08f-427a-84c4-4f01cb2da7d6"],
Cell[72525, 2103, 241, 6, 35, "Text",ExpressionUUID->"83cdfd9a-989a-4a6e-aefd-8869e7f19bb4"],
Cell[72769, 2111, 776, 23, 51, "Input",ExpressionUUID->"34da5930-89ca-494a-8e98-24fac744f1b2"],
Cell[73548, 2136, 245, 6, 35, "Text",ExpressionUUID->"14813bbb-fb3c-45e7-b9fa-72898a52b048"],
Cell[73796, 2144, 721, 22, 51, "Input",ExpressionUUID->"4c498c8f-f9d7-4d7b-990d-9b9a4afff0d1"],
Cell[74520, 2168, 241, 6, 35, "Text",ExpressionUUID->"d4c675ff-8ac1-484c-b800-4229029fb8af"],
Cell[74764, 2176, 824, 24, 51, "Input",ExpressionUUID->"90efdfd4-1c59-4c8d-8d37-0359402f7a20"],
Cell[75591, 2202, 245, 6, 35, "Text",ExpressionUUID->"1526da83-ef33-465e-b2f5-ae3c57a44f3c"],
Cell[75839, 2210, 906, 27, 51, "Input",ExpressionUUID->"f9285166-4012-42bd-84dc-b92d5a87932b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76782, 2242, 347, 5, 54, "Subsection",ExpressionUUID->"667e89cb-83a7-402b-af53-09262e6d67fb"],
Cell[77132, 2249, 292, 4, 35, "Text",ExpressionUUID->"95719fd8-8ffe-4528-a708-0821e19a109d"],
Cell[77427, 2255, 669, 19, 30, "Input",ExpressionUUID->"7f2f9453-f9b0-4d75-ac82-eeda3e110932"],
Cell[78099, 2276, 652, 17, 35, "Text",ExpressionUUID->"f7cb039a-bd22-4b65-8606-543fc0ddfb48"],
Cell[78754, 2295, 1734, 53, 49, "Input",ExpressionUUID->"7e8cc5e8-f854-420e-aa88-736c59ffb33c"],
Cell[80491, 2350, 302, 7, 35, "Text",ExpressionUUID->"3bf216b9-4fe1-440e-bffc-2368c175b791"],
Cell[80796, 2359, 1408, 43, 49, "Input",ExpressionUUID->"305e470f-cffb-4a91-959c-eedd2aede7fb"],
Cell[82207, 2404, 303, 7, 35, "Text",ExpressionUUID->"098eacbb-17e8-4434-8335-aa1b66330082"],
Cell[82513, 2413, 635, 19, 30, "Input",ExpressionUUID->"80f4c4c8-6b10-4032-b5f9-20d2a1508a7c"],
Cell[83151, 2434, 671, 18, 35, "Text",ExpressionUUID->"e1046d72-a957-4fc0-bb47-95f52fd838be"],
Cell[83825, 2454, 838, 25, 30, "Input",ExpressionUUID->"27a7ef0d-3c3a-42f9-a70d-5e8b46faec7d"],
Cell[84666, 2481, 268, 6, 35, "Text",ExpressionUUID->"4532774d-16c0-49e4-925e-2ec868daaae6"],
Cell[84937, 2489, 1936, 62, 52, "Input",ExpressionUUID->"d7ad594b-e842-4737-836f-60236c70c203"],
Cell[86876, 2553, 189, 3, 35, "Text",ExpressionUUID->"c6df52a7-0e5b-4fa6-9c16-63ee45b79b39"],
Cell[87068, 2558, 1263, 32, 51, "Input",ExpressionUUID->"f11d8651-9961-40bd-a8fc-bf9ef7154ca3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88368, 2595, 253, 4, 54, "Subsection",ExpressionUUID->"78fcf983-0dc3-4cae-a06a-1bdefd0bfe27"],
Cell[88624, 2601, 193, 3, 35, "Text",ExpressionUUID->"e48045d9-ef5e-462c-ae7d-5efb063bf048"],
Cell[88820, 2606, 618, 18, 30, "Input",ExpressionUUID->"08df377a-b9cb-4797-b90c-848a9ba3dc51"],
Cell[89441, 2626, 541, 16, 35, "Text",ExpressionUUID->"031af172-d828-40b4-9ba0-dee398f6b072"],
Cell[89985, 2644, 836, 25, 30, "Input",ExpressionUUID->"110a719a-6e7b-45bb-b2ed-eed6ee0c0e8c"],
Cell[90824, 2671, 242, 6, 35, "Text",ExpressionUUID->"db2d3be8-dcc0-4ee8-8c90-34c7e96939eb"],
Cell[91069, 2679, 538, 15, 30, "Input",ExpressionUUID->"d584aeb7-cb68-43e2-ba18-54b1fb1075ef"],
Cell[91610, 2696, 247, 6, 35, "Text",ExpressionUUID->"c03b8363-c900-4f7f-a4fb-461420407a0d"],
Cell[91860, 2704, 1581, 50, 49, "Input",ExpressionUUID->"c7e79035-8f9a-4a51-a878-a63c48ce13b0"],
Cell[93444, 2756, 557, 16, 35, "Text",ExpressionUUID->"c38ff9f4-7847-47a4-aa8e-62706555c084"],
Cell[94004, 2774, 2028, 63, 50, "Input",ExpressionUUID->"20463dcf-7294-475c-81ec-8d4c33f61d96"],
Cell[96035, 2839, 188, 3, 35, "Text",ExpressionUUID->"cf62a804-d2e2-4b23-a08b-d3dcb64ef0db"],
Cell[96226, 2844, 1885, 61, 52, "Input",ExpressionUUID->"7b8710ef-6d6c-4d27-828a-c3ff5f69543f"],
Cell[98114, 2907, 187, 3, 35, "Text",ExpressionUUID->"8c999201-9d8d-472d-8f2d-dc487088ba1a"],
Cell[98304, 2912, 1240, 32, 51, "Input",ExpressionUUID->"9cdcc93d-cc5b-4a86-b454-f93b8ca30359"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99581, 2949, 210, 4, 54, "Subsection",ExpressionUUID->"f446b308-1029-4335-80a1-cdd8ceece6a9"],
Cell[99794, 2955, 193, 3, 35, "Text",ExpressionUUID->"9984ca26-82ad-4ee9-abe7-9e7c8042af71"],
Cell[99990, 2960, 569, 17, 30, "Input",ExpressionUUID->"d0e894ac-96c8-4919-a160-5d026c9147a7"],
Cell[100562, 2979, 583, 16, 35, "Text",ExpressionUUID->"4464e006-5e6c-48a2-8c94-ac0c0c4cddda"],
Cell[101148, 2997, 1959, 61, 50, "Input",ExpressionUUID->"4883df4e-61fb-461f-a1ca-6ab486736b0d"],
Cell[103110, 3060, 232, 6, 35, "Text",ExpressionUUID->"f29227aa-7eb0-4caf-b90e-973a1b10e293"],
Cell[103345, 3068, 1391, 43, 49, "Input",ExpressionUUID->"f83a743d-0a08-4c9f-a11b-bf7818e59131"],
Cell[104739, 3113, 293, 7, 35, "Text",ExpressionUUID->"ac509b1a-91bb-4fc0-89ce-d60c4f36fb3c"],
Cell[105035, 3122, 1521, 48, 49, "Input",ExpressionUUID->"241a5fbc-114e-42fa-afac-c29bef1409c5"],
Cell[106559, 3172, 539, 16, 35, "Text",ExpressionUUID->"b40f7355-25cf-42ad-825d-e31a07e35593"],
Cell[107101, 3190, 1722, 55, 49, "Input",ExpressionUUID->"4bcae745-01c7-455a-b482-67c63ae27bf9"],
Cell[108826, 3247, 188, 3, 35, "Text",ExpressionUUID->"4f8e575a-8808-4dc6-8273-05dee77bb867"],
Cell[109017, 3252, 1766, 58, 30, "Input",ExpressionUUID->"e64d468f-16dd-4184-9003-17795e02efdd"],
Cell[110786, 3312, 187, 3, 35, "Text",ExpressionUUID->"79a8d045-f0c5-4c14-8450-1c1a632f37ed"],
Cell[110976, 3317, 1238, 32, 51, "Input",ExpressionUUID->"bb17b323-b160-4870-9d3d-f225d81ca4f1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112263, 3355, 222, 4, 67, "Section",ExpressionUUID->"7d0cfb07-7814-46d0-b62e-65a9d9fc2790"],
Cell[112488, 3361, 712, 20, 35, "Text",ExpressionUUID->"e372e46b-9961-4054-88d3-a8c0e94635e5"],
Cell[CellGroupData[{
Cell[113225, 3385, 169, 3, 54, "Subsection",ExpressionUUID->"1a91c2b8-1882-4692-b3c2-5b3f19967f70"],
Cell[113397, 3390, 268, 6, 35, "Text",ExpressionUUID->"964e4d74-fe5a-40d0-bb75-86ce6e1ff424"],
Cell[113668, 3398, 2652, 68, 150, "Input",ExpressionUUID->"2af2a3c4-eae6-41d3-9e03-add23f809912"],
Cell[116323, 3468, 268, 6, 35, "Text",ExpressionUUID->"6200b4a4-7a56-47f8-bd72-91cf235101de"],
Cell[116594, 3476, 2560, 67, 150, "Input",ExpressionUUID->"950fbd1f-00e5-456a-b759-d6f78180c451"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119191, 3548, 318, 7, 55, "Subsection",ExpressionUUID->"40cfade3-c292-4776-90ff-5e0975441f56"],
Cell[119512, 3557, 743, 13, 36, "Text",ExpressionUUID->"a852afc3-b0c6-4d05-ba9d-f663784e9b52"],
Cell[120258, 3572, 534, 9, 36, "Text",ExpressionUUID->"87efc7c4-e6c4-43a5-b3ba-6eed808ae11f"],
Cell[120795, 3583, 1528, 39, 53, "Input",ExpressionUUID->"c9c7e578-cdf2-427d-a15f-b91612330649"],
Cell[122326, 3624, 330, 7, 36, "Text",ExpressionUUID->"5ae122ef-2ef8-41de-b42d-649f525d81f4"],
Cell[122659, 3633, 1866, 48, 78, "Input",ExpressionUUID->"04634f8f-c623-41bb-bf33-82154a6227d8"],
Cell[124528, 3683, 288, 6, 36, "Text",ExpressionUUID->"8a3bbe99-3537-4f15-8adc-c73704c2e98a"],
Cell[124819, 3691, 1977, 50, 109, "Input",ExpressionUUID->"d1ea68d7-e001-48ab-b018-86e8dae453d8"],
Cell[126799, 3743, 296, 6, 36, "Text",ExpressionUUID->"2fa9c834-ef70-4ba6-bf30-b9684e4acce7"],
Cell[127098, 3751, 964, 26, 31, "Input",ExpressionUUID->"95c8a060-0090-4859-9813-4237d96f2a66"],
Cell[128065, 3779, 429, 8, 36, "Text",ExpressionUUID->"7fe619b5-db8a-4cc2-92e3-010a4a1262e1"],
Cell[128497, 3789, 1689, 44, 75, "Input",ExpressionUUID->"634a3010-5ded-4ec4-bdcf-932c369b9a67"],
Cell[130189, 3835, 345, 7, 35, "Text",ExpressionUUID->"71505769-c420-4966-a6d2-f39e26b45742"],
Cell[130537, 3844, 1720, 45, 96, "Input",ExpressionUUID->"21ecfb2e-bff4-47da-98e4-d69a4dfb57ab"],
Cell[132260, 3891, 279, 6, 35, "Text",ExpressionUUID->"1d3083de-1241-4cce-bdd5-1744864b8501"],
Cell[132542, 3899, 829, 22, 30, "Input",ExpressionUUID->"cad614ef-0c0b-429a-9d8a-c4c1f24619e9"],
Cell[133374, 3923, 265, 5, 35, "Text",ExpressionUUID->"c02767a7-9611-4c2e-8aeb-cf3574d918f6"],
Cell[133642, 3930, 2555, 64, 168, "Input",ExpressionUUID->"5d8293f0-3ff1-45c3-beb3-8d33102af9f9"],
Cell[136200, 3996, 263, 5, 35, "Text",ExpressionUUID->"00d2a7d7-b7a8-4381-9cbf-7d308d47cbfb"],
Cell[136466, 4003, 2605, 64, 168, "Input",ExpressionUUID->"13f04f9f-799d-44b8-9217-017107badc83"],
Cell[139074, 4069, 166, 3, 35, "Text",ExpressionUUID->"0081abff-b011-4ca5-8d5b-1de24c4d465c"],
Cell[139243, 4074, 1383, 27, 52, "Input",ExpressionUUID->"38b4154d-1fbe-4e37-8aa9-3eb58c1ae009"],
Cell[140629, 4103, 1633, 42, 48, "Input",ExpressionUUID->"20cae176-7913-4156-b0bb-bf30248af555"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[142311, 4151, 283, 4, 67, "Section",ExpressionUUID->"86bc3695-1def-41e7-8695-cd90fea36a99"],
Cell[142597, 4157, 657, 14, 30, "Input",ExpressionUUID->"c60115d9-0f72-48fe-b15a-98f8648035c3"],
Cell[CellGroupData[{
Cell[143279, 4175, 212, 4, 54, "Subsection",ExpressionUUID->"67eb85a4-fc61-4d7b-aa47-fd2dd47acace"],
Cell[143494, 4181, 222, 5, 35, "Text",ExpressionUUID->"09254b2b-890e-48be-b548-7576b5a909c7"],
Cell[143719, 4188, 7583, 187, 283, "Input",ExpressionUUID->"db4052d6-4109-46af-8977-cf688a16f494"],
Cell[151305, 4377, 239, 4, 35, "Text",ExpressionUUID->"3df7ad44-e343-44be-8410-0d5fc0e130ba"],
Cell[151547, 4383, 3110, 76, 136, "Input",ExpressionUUID->"1f71ac4c-fdce-4f10-b40b-2a6aad358e4d"],
Cell[154660, 4461, 257, 6, 35, "Text",ExpressionUUID->"eac960fe-7123-4a44-83a3-f0fab1d3aafb"],
Cell[154920, 4469, 1150, 30, 73, "Input",ExpressionUUID->"f92c11f8-2be9-49da-a4e6-10e59d2edfb9"],
Cell[156073, 4501, 219, 5, 35, "Text",ExpressionUUID->"1ccf26f5-1cb0-4e5a-b40a-1c77821afb44"],
Cell[156295, 4508, 1127, 30, 73, "Input",ExpressionUUID->"3bbbfac3-1d25-4570-bdcb-149a329968fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157459, 4543, 325, 5, 54, "Subsection",ExpressionUUID->"efdb1e39-674c-4da2-a75c-1ab82da8b2dc"],
Cell[157787, 4550, 165, 3, 35, "Text",ExpressionUUID->"69842052-f990-4893-894d-a180424d006e"],
Cell[CellGroupData[{
Cell[157977, 4557, 564, 15, 30, "Input",ExpressionUUID->"833ffd0c-96b7-49e6-9a10-d23e110bf4ce"],
Cell[158544, 4574, 1497, 30, 34, "Output",ExpressionUUID->"b7b7adcd-67e3-487a-a392-48ba14f12a23"]
}, Open  ]],
Cell[160056, 4607, 166, 3, 35, "Text",ExpressionUUID->"69feb794-9791-4e69-9d79-e4e0db398a60"],
Cell[CellGroupData[{
Cell[160247, 4614, 599, 16, 30, "Input",ExpressionUUID->"fc09b6be-003b-4e29-93ea-bfdb7b5b14db"],
Cell[160849, 4632, 1399, 29, 34, "Output",ExpressionUUID->"93cab978-c121-45d7-b2ed-84cef5bd035b"]
}, Open  ]],
Cell[162263, 4664, 192, 3, 35, "Text",ExpressionUUID->"bd46a67c-1947-415c-84ca-f488e94a2f76"],
Cell[162458, 4669, 1165, 29, 52, "Input",ExpressionUUID->"6dedd02a-2b31-4dba-81cd-a161f1b8b308"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163660, 4703, 277, 4, 54, "Subsection",ExpressionUUID->"e2543541-db7a-4b7b-b230-41c43452a459"],
Cell[CellGroupData[{
Cell[163962, 4711, 697, 19, 30, "Input",ExpressionUUID->"373a8966-4b52-4610-b1a3-195c04d22cd2"],
Cell[164662, 4732, 1625, 33, 34, "Output",ExpressionUUID->"fa9c64e3-12ad-4b71-a6df-edaa73def341"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166324, 4770, 784, 20, 30, "Input",ExpressionUUID->"6e9f2cc5-32f8-4a29-88c9-df2edf9edd79"],
Cell[167111, 4792, 1554, 33, 34, "Output",ExpressionUUID->"d1100964-2049-4e54-99fd-c5afce762e26"]
}, Open  ]],
Cell[168680, 4828, 675, 13, 30, "Input",ExpressionUUID->"2337d0c8-f44e-4da9-9b18-ee3acc869c2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169392, 4846, 233, 4, 54, "Subsection",ExpressionUUID->"8339dbb7-1234-4dff-a723-d7369354a45d"],
Cell[CellGroupData[{
Cell[169650, 4854, 1211, 34, 30, "Input",ExpressionUUID->"6960ed50-0ee3-4147-8adf-dcfe9a16b2d0"],
Cell[170864, 4890, 1422, 29, 34, "Output",ExpressionUUID->"d641733b-be18-495a-83a2-adf2e1c7f16f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172323, 4924, 1234, 35, 30, "Input",ExpressionUUID->"55cd71ba-f460-412d-a59f-8023bad6b0c4"],
Cell[173560, 4961, 1470, 30, 34, "Output",ExpressionUUID->"75f51b26-1253-4883-a81c-40ea1ef4f32c"]
}, Open  ]],
Cell[175045, 4994, 919, 24, 30, "Input",ExpressionUUID->"a2dc3bff-3ad0-4087-8697-d38a3c966726"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176001, 5023, 229, 4, 54, "Subsection",ExpressionUUID->"ba0952f0-9cb6-4232-bffe-f8c3c91689ea"],
Cell[176233, 5029, 1191, 23, 30, "Input",ExpressionUUID->"bca23f53-1456-43e3-954e-c7961904b53a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177461, 5057, 235, 4, 54, "Subsection",ExpressionUUID->"f84e47c5-4411-4203-96d3-03aad43da3b5"],
Cell[177699, 5063, 1900, 41, 94, "Input",ExpressionUUID->"89919226-4454-4f4b-92a5-1aef5bf51724"]
}, Open  ]]
}, Open  ]]
}
]
*)

